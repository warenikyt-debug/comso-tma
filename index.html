<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meteor Swarm</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #0a0a1a;
            color: #fff;
            font-family: 'Segoe UI', system-ui, sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            touch-action: manipulation;
        }

        #gameContainer {
            width: 100%;
            height: 100%;
            position: relative;
            background: #0a0a1a;
        }

        #gameCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }

        #uiOverlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(10, 10, 30, 0.85);
            padding: 15px 25px;
            border-radius: 12px;
            border: 2px solid #3498db;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.3);
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .hud-section {
            margin-bottom: 10px;
        }

        .hud-section:last-child {
            margin-bottom: 0;
        }

        .hud-label {
            color: #95a5a6;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .hud-value {
            color: #ecf0f1;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        #score {
            color: #f1c40f;
        }

        #combo {
            color: #9b59b6;
        }

        #clickRate {
            color: #2ecc71;
        }

        #bossHealthContainer {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 70%;
            max-width: 600px;
            background: rgba(10, 10, 30, 0.85);
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid #e74c3c;
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.3);
            backdrop-filter: blur(5px);
            pointer-events: auto;
            display: none;
        }

        #bossHealthBar {
            width: 100%;
            height: 20px;
            background: rgba(44, 62, 80, 0.7);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 8px;
            position: relative;
        }

        #bossHealthFill {
            height: 100%;
            background: linear-gradient(90deg, #e74c3c, #f39c12);
            width: 100%;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        #bossHealthFill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 100%);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        #bossInfo {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #ecf0f1;
            font-size: 16px;
            font-weight: 600;
        }

        #upgradesPanel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(10, 10, 30, 0.85);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #27ae60;
            box-shadow: 0 0 20px rgba(39, 174, 96, 0.3);
            backdrop-filter: blur(5px);
            pointer-events: auto;
            width: 320px;
            display: none;
        }

        .upgrade-item {
            background: rgba(52, 73, 94, 0.6);
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .upgrade-item:hover {
            background: rgba(52, 73, 94, 0.8);
            border-color: #3498db;
            transform: translateY(-2px);
        }

        .upgrade-item:active {
            transform: translateY(0);
        }

        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .upgrade-name {
            color: #ecf0f1;
            font-weight: 600;
            font-size: 16px;
        }

        .upgrade-cost {
            color: #f1c40f;
            font-weight: 700;
            font-size: 14px;
        }

        .upgrade-desc {
            color: #bdc3c7;
            font-size: 13px;
            line-height: 1.4;
        }

        .upgrade-level {
            color: #3498db;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        #gameMenu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(10, 10, 30, 0.95);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #3498db;
            box-shadow: 0 0 40px rgba(52, 152, 219, 0.5);
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 400px;
            pointer-events: auto;
        }

        .menu-title {
            color: #ecf0f1;
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 30px;
            text-shadow: 0 2px 10px rgba(52, 152, 219, 0.7);
        }

        .menu-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .menu-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .menu-button:active {
            transform: translateY(-1px);
        }

        .menu-button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .menu-button:hover::after {
            left: 100%;
        }

        #comboDisplay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0;
            font-weight: 900;
            color: #9b59b6;
            text-shadow: 0 0 20px rgba(155, 89, 182, 0.7);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            z-index: 150;
        }

        #clickEffect {
            position: absolute;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(52, 152, 219, 0.8) 0%, transparent 70%);
            pointer-events: none;
            transform: translate(-50%, -50%);
            opacity: 0;
            z-index: 50;
        }

        #warningOverlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(231, 76, 60, 0.1);
            pointer-events: none;
            opacity: 0;
            z-index: 180;
            transition: opacity 0.3s;
        }

        #abilityBar {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            pointer-events: auto;
        }

        .ability-button {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(10, 10, 30, 0.85);
            border: 2px solid #9b59b6;
            color: #ecf0f1;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(155, 89, 182, 0.3);
        }

        .ability-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(155, 89, 182, 0.5);
        }

        .ability-button:active {
            transform: scale(0.95);
        }

        .ability-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #7f8c8d;
        }

        .ability-button.disabled:hover {
            transform: none;
            box-shadow: 0 0 15px rgba(155, 89, 182, 0.3);
        }

        .ability-cooldown {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        #phaseIndicator {
            position: absolute;
            top: 100px;
            right: 20px;
            background: rgba(10, 10, 30, 0.85);
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid #e67e22;
            box-shadow: 0 0 20px rgba(230, 126, 34, 0.3);
            color: #ecf0f1;
            font-weight: 600;
            pointer-events: auto;
            display: none;
        }

        #meteorCounter {
            position: absolute;
            top: 160px;
            right: 20px;
            background: rgba(10, 10, 30, 0.85);
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid #1abc9c;
            box-shadow: 0 0 20px rgba(26, 188, 156, 0.3);
            color: #ecf0f1;
            font-weight: 600;
            pointer-events: auto;
        }

        #tutorial {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 10, 30, 0.9);
            padding: 15px 25px;
            border-radius: 12px;
            border: 2px solid #f1c40f;
            color: #ecf0f1;
            font-size: 14px;
            text-align: center;
            max-width: 500px;
            pointer-events: none;
            opacity: 1;
            transition: opacity 1s;
        }

        #tutorial.hidden {
            opacity: 0;
        }

        #achievementToast {
            position: fixed;
            top: 20px;
            right: -400px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            padding: 15px 25px;
            border-radius: 10px;
            border-left: 5px solid #f1c40f;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 200;
            max-width: 350px;
        }

        .achievement-title {
            color: #f1c40f;
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .achievement-desc {
            color: #ecf0f1;
            font-size: 14px;
        }

        #damageNumbers {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 120;
        }

        .damage-number {
            position: absolute;
            color: #e74c3c;
            font-weight: 900;
            font-size: 24px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            opacity: 1;
            transform: translateY(0);
            transition: all 1s;
        }

        #particleContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 80;
        }

        #bossIntro {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(10, 10, 30, 0.95);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #e74c3c;
            box-shadow: 0 0 40px rgba(231, 76, 60, 0.5);
            text-align: center;
            min-width: 500px;
            pointer-events: none;
            opacity: 0;
            z-index: 190;
            transition: opacity 0.5s;
        }

        .boss-name {
            color: #e74c3c;
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(231, 76, 60, 0.7);
        }

        .boss-desc {
            color: #ecf0f1;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .boss-ability {
            color: #f1c40f;
            font-size: 16px;
            font-style: italic;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            #hud {
                padding: 10px 15px;
                left: 10px;
                top: 10px;
            }

            .hud-value {
                font-size: 18px;
            }

            #upgradesPanel {
                width: calc(100% - 40px);
                left: 20px;
                padding: 15px;
            }

            #gameMenu {
                min-width: 90%;
                padding: 30px 20px;
                left: 50%;
            }

            .menu-title {
                font-size: 28px;
            }

            .menu-button {
                padding: 14px 24px;
                font-size: 16px;
            }

            #abilityBar {
                bottom: 10px;
                right: 10px;
                gap: 10px;
            }

            .ability-button {
                width: 60px;
                height: 60px;
                font-size: 20px;
            }

            #phaseIndicator,
            #meteorCounter {
                right: 10px;
                padding: 8px 15px;
            }

            #phaseIndicator {
                top: 80px;
            }

            #meteorCounter {
                top: 140px;
            }

            #tutorial {
                width: calc(100% - 40px);
                bottom: 100px;
                font-size: 12px;
                padding: 10px 15px;
            }

            #bossIntro {
                min-width: 90%;
                padding: 30px 20px;
            }

            .boss-name {
                font-size: 32px;
            }

            .boss-desc {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .hud-value {
                font-size: 16px;
            }

            .ability-button {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }

            #upgradesPanel {
                width: calc(100% - 20px);
                left: 10px;
                bottom: 10px;
                padding: 10px;
            }

            .upgrade-item {
                padding: 8px 10px;
            }

            .upgrade-name {
                font-size: 14px;
            }

            .upgrade-desc {
                font-size: 12px;
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(52, 152, 219, 0.3); }
            50% { box-shadow: 0 0 30px rgba(52, 152, 219, 0.6); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .shake {
            animation: shake 0.5s;
        }

        .float {
            animation: float 3s ease-in-out infinite;
        }

        .glow {
            animation: glow 1.5s infinite;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <div id="uiOverlay">
            <div id="hud">
                <div class="hud-section">
                    <div class="hud-label">Score</div>
                    <div class="hud-value" id="score">0</div>
                </div>
                <div class="hud-section">
                    <div class="hud-label">Combo</div>
                    <div class="hud-value" id="combo">1.0x</div>
                </div>
                <div class="hud-section">
                    <div class="hud-label">Click Power</div>
                    <div class="hud-value" id="clickRate">1.0</div>
                </div>
            </div>
            
            <div id="bossHealthContainer">
                <div id="bossInfo">
                    <span id="bossName">Boss Name</span>
                    <span id="bossHealthText">100%</span>
                </div>
                <div id="bossHealthBar">
                    <div id="bossHealthFill"></div>
                </div>
            </div>
            
            <div id="upgradesPanel">
                <div class="upgrade-item" id="upgradeSpeed">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Meteor Speed</div>
                        <div class="upgrade-cost">100</div>
                    </div>
                    <div class="upgrade-desc">Increase meteor movement speed by 20%</div>
                    <div class="upgrade-level">Level: 1</div>
                </div>
                <div class="upgrade-item" id="upgradeDamage">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Impact Damage</div>
                        <div class="upgrade-cost">150</div>
                    </div>
                    <div class="upgrade-desc">Increase meteor damage by 15%</div>
                    <div class="upgrade-level">Level: 1</div>
                </div>
                <div class="upgrade-item" id="upgradeSpawn">
                    <div class="upgrade-header">
                        <div class="upgrade-name">Spawn Rate</div>
                        <div class="upgrade-cost">200</div>
                    </div>
                    <div class="upgrade-desc">Increase meteor spawn rate by 10%</div>
                    <div class="upgrade-level">Level: 1</div>
                </div>
            </div>
            
            <div id="gameMenu">
                <div class="menu-title">Meteor Swarm</div>
                <button class="menu-button" id="startButton">Start Game</button>
                <button class="menu-button" id="continueButton" style="display: none;">Continue</button>
                <button class="menu-button" id="upgradesButton">Upgrades</button>
                <button class="menu-button" id="statsButton">Statistics</button>
            </div>
            
            <div id="comboDisplay"></div>
            
            <div id="clickEffect"></div>
            
            <div id="warningOverlay"></div>
            
            <div id="abilityBar">
                <div class="ability-button" id="ability1" title="Time Warp">
                    ‚è±Ô∏è
                    <div class="ability-cooldown"></div>
                </div>
                <div class="ability-button" id="ability2" title="Meteor Rain">
                    ‚òÑÔ∏è
                    <div class="ability-cooldown"></div>
                </div>
                <div class="ability-button" id="ability3" title="Shield">
                    üõ°Ô∏è
                    <div class="ability-cooldown"></div>
                </div>
                <div class="ability-button" id="ability4" title="Supernova">
                    üí•
                    <div class="ability-cooldown"></div>
                </div>
            </div>
            
            <div id="phaseIndicator">
                Phase: <span id="phaseNumber">1</span>
            </div>
            
            <div id="meteorCounter">
                Meteors: <span id="meteorCount">0</span>
            </div>
            
            <div id="tutorial">
                Click anywhere to guide meteors. Click faster to increase speed!
            </div>
            
            <div id="achievementToast">
                <div class="achievement-title">Achievement Unlocked!</div>
                <div class="achievement-desc">First Blood - Defeat your first boss</div>
            </div>
            
            <div id="damageNumbers"></div>
            
            <div id="particleContainer"></div>
            
            <div id="bossIntro">
                <div class="boss-name" id="introBossName">Boss Name</div>
                <div class="boss-desc" id="introBossDesc">Boss description here</div>
                <div class="boss-ability" id="introBossAbility">Special Ability: None</div>
            </div>
        </div>
    </div>

    <script>
        // =================================================================
        // METEOR SWARM - –ú–ê–°–®–¢–ê–ë–ù–ê–Ø –ò–ì–†–ê –ù–ê 5000+ –°–¢–†–û–ö
        // =================================================================

        // -----------------------------------------------------------------
        // 1. –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        // -----------------------------------------------------------------
        const CANVAS = document.getElementById('gameCanvas');
        const CTX = CANVAS.getContext('2d');
        const UI = {
            score: document.getElementById('score'),
            combo: document.getElementById('combo'),
            clickRate: document.getElementById('clickRate'),
            bossHealth: document.getElementById('bossHealthContainer'),
            bossHealthFill: document.getElementById('bossHealthFill'),
            bossHealthText: document.getElementById('bossHealthText'),
            bossName: document.getElementById('bossName'),
            meteorCount: document.getElementById('meteorCount'),
            phaseNumber: document.getElementById('phaseNumber'),
            comboDisplay: document.getElementById('comboDisplay'),
            clickEffect: document.getElementById('clickEffect'),
            warningOverlay: document.getElementById('warningOverlay'),
            tutorial: document.getElementById('tutorial'),
            achievementToast: document.getElementById('achievementToast'),
            damageNumbers: document.getElementById('damageNumbers'),
            particleContainer: document.getElementById('particleContainer'),
            bossIntro: document.getElementById('bossIntro'),
            introBossName: document.getElementById('introBossName'),
            introBossDesc: document.getElementById('introBossDesc'),
            introBossAbility: document.getElementById('introBossAbility'),
            upgradesPanel: document.getElementById('upgradesPanel'),
            gameMenu: document.getElementById('gameMenu'),
            startButton: document.getElementById('startButton'),
            continueButton: document.getElementById('continueButton'),
            upgradesButton: document.getElementById('upgradesButton'),
            statsButton: document.getElementById('statsButton')
        };

        // –£–ª—É—á—à–µ–Ω–∏—è
        const UPGRADES = {
            speed: {
                element: document.getElementById('upgradeSpeed'),
                cost: 100,
                level: 1,
                costMultiplier: 1.5,
                effect: 0.2
            },
            damage: {
                element: document.getElementById('upgradeDamage'),
                cost: 150,
                level: 1,
                costMultiplier: 1.6,
                effect: 0.15
            },
            spawn: {
                element: document.getElementById('upgradeSpawn'),
                cost: 200,
                level: 1,
                costMultiplier: 1.7,
                effect: 0.1
            }
        };

        // –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
        const ABILITIES = {
            timeWarp: {
                element: document.getElementById('ability1'),
                cooldown: 30000, // 30 —Å–µ–∫—É–Ω–¥
                activeTime: 5000, // 5 —Å–µ–∫—É–Ω–¥
                lastUsed: 0,
                active: false
            },
            meteorRain: {
                element: document.getElementById('ability2'),
                cooldown: 45000, // 45 —Å–µ–∫—É–Ω–¥
                lastUsed: 0,
                active: false
            },
            shield: {
                element: document.getElementById('ability3'),
                cooldown: 60000, // 60 —Å–µ–∫—É–Ω–¥
                activeTime: 10000, // 10 —Å–µ–∫—É–Ω–¥
                lastUsed: 0,
                active: false
            },
            supernova: {
                element: document.getElementById('ability4'),
                cooldown: 90000, // 90 —Å–µ–∫—É–Ω–¥
                lastUsed: 0,
                active: false
            }
        };

        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let GAME = {
            running: false,
            paused: false,
            score: 0,
            combo: 1.0,
            clickRate: 1.0,
            baseClickPower: 1.0,
            clickMultiplier: 1.0,
            meteorCount: 0,
            phase: 1,
            wave: 1,
            bossActive: false,
            currentBoss: null,
            bossesDefeated: 0,
            meteorsDestroyed: 0,
            totalClicks: 0,
            clickStreak: 0,
            lastClickTime: 0,
            maxClickStreak: 0,
            gameTime: 0,
            meteorSpawnTimer: 0,
            meteorSpawnDelay: 120, // 2 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–∏ 60 FPS
            spawnPosition: { x: 0, y: 0 },
            camera: { x: 0, y: 0, zoom: 1 },
            particles: [],
            damageNumbers: [],
            achievements: new Set(),
            upgrades: JSON.parse(localStorage.getItem('meteorSwarm_upgrades')) || {
                speed: 1,
                damage: 1,
                spawn: 1,
                special: 0
            },
            stats: JSON.parse(localStorage.getItem('meteorSwarm_stats')) || {
                totalScore: 0,
                totalBosses: 0,
                totalMeteors: 0,
                totalClicks: 0,
                playTime: 0,
                highestCombo: 1,
                highestClickRate: 1
            },
            settings: JSON.parse(localStorage.getItem('meteorSwarm_settings')) || {
                sound: true,
                music: true,
                particles: true,
                screenShake: true
            }
        };

        // –û–±—ä–µ–∫—Ç—ã –∏–≥—Ä—ã
        let METEORS = [];
        let BOSSES = [];
        let PROJECTILES = [];
        let EFFECTS = [];
        let STARS = [];

        // -----------------------------------------------------------------
        // 2. –°–ò–°–¢–ï–ú–ê –ë–û–°–°–û–í (10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –±–æ—Å—Å–æ–≤)
        // -----------------------------------------------------------------
        const BOSS_TYPES = {
            // 1. –ê—Å—Ç–µ—Ä–æ–∏–¥–Ω—ã–π –≥–∏–≥–∞–Ω—Ç
            ASTEROID_GIANT: {
                name: "Asteroid Giant",
                description: "A massive asteroid covered in mining facilities",
                color: "#7f8c8d",
                size: 180,
                health: 1000,
                speed: 1.5,
                abilities: [
                    {
                        name: "Rock Throw",
                        cooldown: 120,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ë—Ä–æ—Å–∞–µ—Ç –±–æ–ª—å—à–∏–µ –∫–∞–º–Ω–∏
                            for (let i = 0; i < 8; i++) {
                                const angle = (i / 8) * Math.PI * 2;
                                PROJECTILES.push({
                                    x: boss.x,
                                    y: boss.y,
                                    size: 20,
                                    speed: 4,
                                    angle: angle,
                                    color: "#95a5a6",
                                    damage: 10,
                                    type: "rock"
                                });
                            }
                        }
                    },
                    {
                        name: "Gravity Well",
                        cooldown: 300,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –°–æ–∑–¥–∞–µ—Ç –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—É—é –≤–æ—Ä–æ–Ω–∫—É
                            EFFECTS.push({
                                type: "gravity",
                                x: boss.x,
                                y: boss.y,
                                radius: 200,
                                strength: 0.5,
                                duration: 180
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.7, speedMultiplier: 1.2 },
                    { healthThreshold: 0.4, speedMultiplier: 1.5 },
                    { healthThreshold: 0.1, speedMultiplier: 2.0 }
                ],
                deathEffect: "explosion"
            },

            // 2. –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –¥—Ä–∞–∫–æ–Ω
            SPACE_DRAGON: {
                name: "Space Dragon",
                description: "Ancient cosmic entity that feeds on asteroids",
                color: "#9b59b6",
                size: 200,
                health: 1500,
                speed: 2.0,
                abilities: [
                    {
                        name: "Dragon Breath",
                        cooldown: 90,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –î—ã—Ö–∞–Ω–∏–µ –¥—Ä–∞–∫–æ–Ω–∞ - –∫–æ–Ω—É—Å –æ–≥–Ω—è
                            const angle = Math.atan2(
                                GAME.spawnPosition.y - boss.y,
                                GAME.spawnPosition.x - boss.x
                            );
                            
                            for (let i = -3; i <= 3; i++) {
                                const fireAngle = angle + i * 0.2;
                                PROJECTILES.push({
                                    x: boss.x,
                                    y: boss.y,
                                    size: 15,
                                    speed: 6,
                                    angle: fireAngle,
                                    color: "#e74c3c",
                                    damage: 15,
                                    type: "fire",
                                    trail: true
                                });
                            }
                        }
                    },
                    {
                        name: "Tail Whip",
                        cooldown: 180,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –£–¥–∞—Ä —Ö–≤–æ—Å—Ç–æ–º - –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–µ—Ç –º–µ—Ç–µ–æ—Ä—ã
                            METEORS.forEach(meteor => {
                                const dx = meteor.x - boss.x;
                                const dy = meteor.y - boss.y;
                                const distance = Math.sqrt(dx * dx + dy * dy);
                                
                                if (distance < 250) {
                                    const force = 10 / distance;
                                    meteor.vx += dx * force;
                                    meteor.vy += dy * force;
                                }
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.8, addsWings: true },
                    { healthThreshold: 0.5, fireRate: 1.5 },
                    { healthThreshold: 0.2, enraged: true }
                ],
                deathEffect: "implosion"
            },

            // 3. –§–ª–æ—Ç –∫—Ä–µ–π—Å–µ—Ä–æ–≤
            CRUISER_FLEET: {
                name: "Cruiser Fleet",
                description: "A swarm of coordinated battle cruisers",
                color: "#3498db",
                size: 160,
                health: 1200,
                speed: 2.5,
                abilities: [
                    {
                        name: "Formation Attack",
                        cooldown: 150,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ê—Ç–∞–∫–∞ —Å—Ç—Ä–æ–µ–º - –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ—Ä–∞–±–ª–µ–π —Å—Ç—Ä–µ–ª—è—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
                            const formation = [
                                { x: -80, y: -40 },
                                { x: 80, y: -40 },
                                { x: -80, y: 40 },
                                { x: 80, y: 40 }
                            ];
                            
                            formation.forEach(pos => {
                                const targetX = GAME.spawnPosition.x + (Math.random() - 0.5) * 100;
                                const targetY = GAME.spawnPosition.y + (Math.random() - 0.5) * 100;
                                const angle = Math.atan2(targetY - (boss.y + pos.y), targetX - (boss.x + pos.x));
                                
                                PROJECTILES.push({
                                    x: boss.x + pos.x,
                                    y: boss.y + pos.y,
                                    size: 12,
                                    speed: 5,
                                    angle: angle,
                                    color: "#2980b9",
                                    damage: 8,
                                    type: "laser"
                                });
                            });
                        }
                    },
                    {
                        name: "Shield Wall",
                        cooldown: 300,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —â–∏—Ç—ã
                            EFFECTS.push({
                                type: "shield",
                                x: boss.x,
                                y: boss.y,
                                radius: boss.size + 50,
                                duration: 240
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.75, formation: "circle" },
                    { healthThreshold: 0.5, formation: "line" },
                    { healthThreshold: 0.25, formation: "star" }
                ],
                deathEffect: "chainExplosion"
            },

            // 4. –ñ–∏–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞
            LIVING_PLANET: {
                name: "Living Planet",
                description: "A sentient planet with planetary defenses",
                color: "#27ae60",
                size: 220,
                health: 2000,
                speed: 0.8,
                abilities: [
                    {
                        name: "Planetary Ring",
                        cooldown: 200,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –°–æ–∑–¥–∞–µ—Ç –∫–æ–ª—å—Ü–æ –∏–∑ –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤ –≤–æ–∫—Ä—É–≥ —Å–µ–±—è
                            for (let i = 0; i < 12; i++) {
                                const angle = (i / 12) * Math.PI * 2;
                                const distance = boss.size + 100;
                                
                                METEORS.push({
                                    x: boss.x + Math.cos(angle) * distance,
                                    y: boss.y + Math.sin(angle) * distance,
                                    size: 30,
                                    speed: 1,
                                    angle: angle + Math.PI / 2,
                                    color: "#2ecc71",
                                    health: 50,
                                    maxHealth: 50,
                                    type: "planetRing",
                                    orbit: {
                                        centerX: boss.x,
                                        centerY: boss.y,
                                        distance: distance,
                                        speed: 0.02
                                    }
                                });
                            }
                        }
                    },
                    {
                        name: "Gravity Crush",
                        cooldown: 400,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –°–∏–ª—å–Ω–∞—è –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –∞—Ç–∞–∫–∞
                            EFFECTS.push({
                                type: "gravityCrush",
                                x: boss.x,
                                y: boss.y,
                                radius: 300,
                                strength: 1.0,
                                duration: 120
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.8, ringCount: 12 },
                    { healthThreshold: 0.6, ringCount: 16 },
                    { healthThreshold: 0.3, ringCount: 20 }
                ],
                deathEffect: "planetCrack"
            },

            // 5. –ö–≤–∞–Ω—Ç–æ–≤—ã–π —Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å
            QUANTUM_DESTROYER: {
                name: "Quantum Destroyer",
                description: "Advanced weapon using quantum technology",
                color: "#1abc9c",
                size: 140,
                health: 800,
                speed: 3.0,
                abilities: [
                    {
                        name: "Quantum Beam",
                        cooldown: 60,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ú–æ—â–Ω—ã–π –∫–≤–∞–Ω—Ç–æ–≤—ã–π –ª—É—á
                            const angle = Math.atan2(
                                GAME.spawnPosition.y - boss.y,
                                GAME.spawnPosition.x - boss.x
                            );
                            
                            PROJECTILES.push({
                                x: boss.x,
                                y: boss.y,
                                size: 25,
                                speed: 8,
                                angle: angle,
                                color: "#1abc9c",
                                damage: 25,
                                type: "quantum",
                                piercing: true
                            });
                        }
                    },
                    {
                        name: "Phase Shift",
                        cooldown: 180,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è
                            boss.x = Math.random() * (CANVAS.width - 400) + 200;
                            boss.y = Math.random() * (CANVAS.height - 400) + 200;
                            
                            // –≠—Ñ—Ñ–µ–∫—Ç —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
                            createParticles(boss.x, boss.y, 50, "#1abc9c");
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.7, beamCount: 2 },
                    { healthThreshold: 0.4, beamCount: 3 },
                    { healthThreshold: 0.1, beamCount: 4 }
                ],
                deathEffect: "quantumImplosion"
            },

            // 6. –ù–µ–∫—Ä–æ-–∞—Å—Ç–µ—Ä–æ–∏–¥
            NECRO_ASTEROID: {
                name: "Necro Asteroid",
                description: "Undead asteroid reanimated by dark energy",
                color: "#34495e",
                size: 190,
                health: 1600,
                speed: 1.2,
                abilities: [
                    {
                        name: "Death Grip",
                        cooldown: 100,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç –º–µ—Ç–µ–æ—Ä—ã –∫ —Å–µ–±–µ
                            METEORS.forEach(meteor => {
                                const dx = boss.x - meteor.x;
                                const dy = boss.y - meteor.y;
                                const distance = Math.sqrt(dx * dx + dy * dy);
                                
                                if (distance < 400) {
                                    const force = 0.5 / distance;
                                    meteor.vx += dx * force;
                                    meteor.vy += dy * force;
                                }
                            });
                        }
                    },
                    {
                        name: "Soul Drain",
                        cooldown: 250,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –∑–∞ —Å—á–µ—Ç –º–µ—Ç–µ–æ—Ä–æ–≤
                            METEORS.forEach(meteor => {
                                const dx = boss.x - meteor.x;
                                const dy = boss.y - meteor.y;
                                const distance = Math.sqrt(dx * dx + dy * dy);
                                
                                if (distance < 150) {
                                    meteor.health -= 10;
                                    boss.health += 5;
                                    
                                    createParticles(meteor.x, meteor.y, 10, "#8e44ad");
                                    
                                    if (meteor.health <= 0) {
                                        METEORS = METEORS.filter(m => m !== meteor);
                                        GAME.meteorsDestroyed++;
                                    }
                                }
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.75, drainRadius: 150 },
                    { healthThreshold: 0.5, drainRadius: 200 },
                    { healthThreshold: 0.25, drainRadius: 250 }
                ],
                deathEffect: "darkExplosion"
            },

            // 7. –°–æ–ª–Ω–µ—á–Ω—ã–π –≥–∏–≥–∞–Ω—Ç
            SOLAR_GIANT: {
                name: "Solar Giant",
                description: "A miniature star with solar flares",
                color: "#f39c12",
                size: 210,
                health: 1800,
                speed: 1.0,
                abilities: [
                    {
                        name: "Solar Flare",
                        cooldown: 80,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –í—ã–±—Ä–æ—Å —Å–æ–ª–Ω–µ—á–Ω–æ–π –ø–ª–∞–∑–º—ã
                            for (let i = 0; i < 16; i++) {
                                const angle = (i / 16) * Math.PI * 2;
                                PROJECTILES.push({
                                    x: boss.x,
                                    y: boss.y,
                                    size: 18,
                                    speed: 4,
                                    angle: angle,
                                    color: "#f1c40f",
                                    damage: 12,
                                    type: "plasma",
                                    homing: true
                                });
                            }
                        }
                    },
                    {
                        name: "Nova Burst",
                        cooldown: 350,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ú–æ—â–Ω–∞—è –≤–∑—Ä—ã–≤–Ω–∞—è –≤–æ–ª–Ω–∞
                            EFFECTS.push({
                                type: "nova",
                                x: boss.x,
                                y: boss.y,
                                radius: 0,
                                maxRadius: 350,
                                speed: 10,
                                damage: 20
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.8, flareCount: 16 },
                    { healthThreshold: 0.6, flareCount: 20 },
                    { healthThreshold: 0.3, flareCount: 24 }
                ],
                deathEffect: "supernova"
            },

            // 8. –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π —Ç–∏—Ç–∞–Ω
            MECHANICAL_TITAN: {
                name: "Mechanical Titan",
                description: "Gigantic war machine from ancient civilization",
                color: "#e67e22",
                size: 230,
                health: 2200,
                speed: 0.7,
                abilities: [
                    {
                        name: "Missile Barrage",
                        cooldown: 120,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –†–∞–∫–µ—Ç–Ω—ã–π –∑–∞–ª–ø
                            for (let i = 0; i < 6; i++) {
                                const targetX = GAME.spawnPosition.x + (Math.random() - 0.5) * 200;
                                const targetY = GAME.spawnPosition.y + (Math.random() - 0.5) * 200;
                                const angle = Math.atan2(targetY - boss.y, targetX - boss.x);
                                
                                PROJECTILES.push({
                                    x: boss.x,
                                    y: boss.y,
                                    size: 22,
                                    speed: 3,
                                    angle: angle,
                                    color: "#d35400",
                                    damage: 18,
                                    type: "missile",
                                    tracking: true,
                                    targetX: targetX,
                                    targetY: targetY
                                });
                            }
                        }
                    },
                    {
                        name: "Repair Drones",
                        cooldown: 300,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –í—ã–ø—É—Å–∫–∞–µ—Ç –¥—Ä–æ–Ω–æ–≤ –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞
                            for (let i = 0; i < 4; i++) {
                                const angle = (i / 4) * Math.PI * 2;
                                const distance = 100;
                                
                                EFFECTS.push({
                                    type: "repairDrone",
                                    x: boss.x + Math.cos(angle) * distance,
                                    y: boss.y + Math.sin(angle) * distance,
                                    angle: angle,
                                    speed: 1,
                                    target: boss,
                                    healRate: 2,
                                    duration: 300
                                });
                            }
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.8, armor: 10 },
                    { healthThreshold: 0.6, armor: 20 },
                    { healthThreshold: 0.3, armor: 30 }
                ],
                deathEffect: "coreBreach"
            },

            // 9. –í–∏—Ö—Ä–µ–≤–æ–π –ø–æ–≥–ª–æ—Ç–∏—Ç–µ–ª—å
            VORTEX_CONSUMER: {
                name: "Vortex Consumer",
                description: "Black hole that devours everything in its path",
                color: "#2c3e50",
                size: 170,
                health: 1400,
                speed: 1.8,
                abilities: [
                    {
                        name: "Singularity Pull",
                        cooldown: 90,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –°–∏–ª—å–Ω–æ–µ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ
                            EFFECTS.push({
                                type: "singularity",
                                x: boss.x,
                                y: boss.y,
                                radius: 250,
                                strength: 0.8,
                                duration: 150
                            });
                        }
                    },
                    {
                        name: "Event Horizon",
                        cooldown: 280,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –†–∞—Å—à–∏—Ä—è—é—â–∏–π—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç —Å–æ–±—ã—Ç–∏–π
                            EFFECTS.push({
                                type: "eventHorizon",
                                x: boss.x,
                                y: boss.y,
                                radius: 50,
                                maxRadius: 400,
                                speed: 2,
                                damage: 30
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.75, pullStrength: 0.8 },
                    { healthThreshold: 0.5, pullStrength: 1.0 },
                    { healthThreshold: 0.25, pullStrength: 1.2 }
                ],
                deathEffect: "blackholeCollapse"
            },

            // 10. –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä–±–∏—Ç—Ä
            DIVINE_ARBITER: {
                name: "Divine Arbiter",
                description: "Celestial being judging the fate of asteroids",
                color: "#ecf0f1",
                size: 240,
                health: 2500,
                speed: 0.5,
                abilities: [
                    {
                        name: "Judgment Beam",
                        cooldown: 70,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –õ—É—á –±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å—É–¥–∞
                            const targets = METEORS.slice(0, 3);
                            targets.forEach(meteor => {
                                const angle = Math.atan2(meteor.y - boss.y, meteor.x - boss.x);
                                
                                PROJECTILES.push({
                                    x: boss.x,
                                    y: boss.y,
                                    size: 30,
                                    speed: 7,
                                    angle: angle,
                                    color: "#ffffff",
                                    damage: 40,
                                    type: "judgment",
                                    homing: true,
                                    target: meteor
                                });
                            });
                        }
                    },
                    {
                        name: "Divine Protection",
                        cooldown: 320,
                        lastUsed: 0,
                        execute: function(boss) {
                            // –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞
                            EFFECTS.push({
                                type: "divineShield",
                                x: boss.x,
                                y: boss.y,
                                radius: boss.size + 100,
                                duration: 200,
                                damageReduction: 0.5
                            });
                        }
                    }
                ],
                phases: [
                    { healthThreshold: 0.8, judgmentCount: 3 },
                    { healthThreshold: 0.6, judgmentCount: 4 },
                    { healthThreshold: 0.3, judgmentCount: 5 }
                ],
                deathEffect: "ascension"
            }
        };

        // -----------------------------------------------------------------
        // 3. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´
        // -----------------------------------------------------------------
        function initGame() {
            console.log("Initializing Meteor Swarm...");
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ canvas
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—ë–∑–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞
            initStars();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π
            loadGame();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
            
            console.log("Game initialized successfully!");
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            requestAnimationFrame(gameLoop);
        }

        function resizeCanvas() {
            CANVAS.width = window.innerWidth;
            CANVAS.height = window.innerHeight;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–ø–∞–≤–Ω–∞
            GAME.spawnPosition = {
                x: CANVAS.width / 2,
                y: CANVAS.height / 2
            };
        }

        function initStars() {
            STARS = [];
            const starCount = Math.min(500, Math.floor((CANVAS.width * CANVAS.height) / 1000));
            
            for (let i = 0; i < starCount; i++) {
                STARS.push({
                    x: Math.random() * CANVAS.width,
                    y: Math.random() * CANVAS.height,
                    size: Math.random() * 3 + 1,
                    brightness: Math.random() * 0.8 + 0.2,
                    speed: Math.random() * 0.5 + 0.1,
                    twinkle: Math.random() * Math.PI * 2
                });
            }
        }

        function loadGame() {
            try {
                const saved = localStorage.getItem('meteorSwarm_save');
                if (saved) {
                    const data = JSON.parse(saved);
                    
                    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    GAME.score = data.score || 0;
                    GAME.bossesDefeated = data.bossesDefeated || 0;
                    GAME.meteorsDestroyed = data.meteorsDestroyed || 0;
                    GAME.totalClicks = data.totalClicks || 0;
                    GAME.maxClickStreak = data.maxClickStreak || 0;
                    GAME.gameTime = data.gameTime || 0;
                    GAME.upgrades = data.upgrades || GAME.upgrades;
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
                    UI.continueButton.style.display = 'block';
                }
            } catch (e) {
                console.error("Error loading save:", e);
            }
        }

        function saveGame() {
            try {
                const saveData = {
                    score: GAME.score,
                    bossesDefeated: GAME.bossesDefeated,
                    meteorsDestroyed: GAME.meteorsDestroyed,
                    totalClicks: GAME.totalClicks,
                    maxClickStreak: GAME.maxClickStreak,
                    gameTime: GAME.gameTime,
                    upgrades: GAME.upgrades,
                    timestamp: Date.now()
                };
                
                localStorage.setItem('meteorSwarm_save', JSON.stringify(saveData));
                localStorage.setItem('meteorSwarm_stats', JSON.stringify(GAME.stats));
                localStorage.setItem('meteorSwarm_upgrades', JSON.stringify(GAME.upgrades));
            } catch (e) {
                console.error("Error saving game:", e);
            }
        }

        // -----------------------------------------------------------------
        // 4. –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô
        // -----------------------------------------------------------------
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é
            UI.startButton.addEventListener('click', startNewGame);
            UI.continueButton.addEventListener('click', continueGame);
            UI.upgradesButton.addEventListener('click', toggleUpgrades);
            UI.statsButton.addEventListener('click', showStats);
            
            // –ö–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π
            UPGRADES.speed.element.addEventListener('click', () => purchaseUpgrade('speed'));
            UPGRADES.damage.element.addEventListener('click', () => purchaseUpgrade('damage'));
            UPGRADES.spawn.element.addEventListener('click', () => purchaseUpgrade('spawn'));
            
            // –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            ABILITIES.timeWarp.element.addEventListener('click', () => activateAbility('timeWarp'));
            ABILITIES.meteorRain.element.addEventListener('click', () => activateAbility('meteorRain'));
            ABILITIES.shield.element.addEventListener('click', () => activateAbility('shield'));
            ABILITIES.supernova.element.addEventListener('click', () => activateAbility('supernova'));
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–∫–∞–º–∏
            CANVAS.addEventListener('click', handleCanvasClick);
            CANVAS.addEventListener('touchstart', handleTouchStart, { passive: false });
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            document.addEventListener('keydown', handleKeyDown);
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            setInterval(saveGame, 60000);
        }

        function handleCanvasClick(e) {
            if (!GAME.running || GAME.paused) return;
            
            const rect = CANVAS.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            processClick(x, y);
        }

        function handleTouchStart(e) {
            if (!GAME.running || GAME.paused) return;
            
            e.preventDefault();
            
            const rect = CANVAS.getBoundingClientRect();
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            
            processClick(x, y);
        }

        function handleKeyDown(e) {
            switch(e.key) {
                case ' ':
                case 'Spacebar':
                    e.preventDefault();
                    if (!GAME.running) startNewGame();
                    break;
                    
                case 'Escape':
                    e.preventDefault();
                    togglePause();
                    break;
                    
                case '1':
                case '2':
                case '3':
                case '4':
                    const abilityIndex = parseInt(e.key) - 1;
                    const abilities = Object.keys(ABILITIES);
                    if (abilities[abilityIndex]) {
                        activateAbility(abilities[abilityIndex]);
                    }
                    break;
                    
                case 'u':
                case 'U':
                    toggleUpgrades();
                    break;
            }
        }

        // -----------------------------------------------------------------
        // 5. –û–°–ù–û–í–ù–û–ô –ì–ï–ô–ú–ü–õ–ï–ô
        // -----------------------------------------------------------------
        function processClick(x, y) {
            GAME.totalClicks++;
            GAME.clickStreak++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
            const now = Date.now();
            if (GAME.lastClickTime > 0) {
                const timeDiff = now - GAME.lastClickTime;
                if (timeDiff < 1000) {
                    GAME.clickRate = Math.min(10, GAME.clickRate + 0.1);
                } else {
                    GAME.clickRate = Math.max(1, GAME.clickRate * 0.9);
                }
            }
            GAME.lastClickTime = now;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–º–±–æ
            updateCombo();
            
            // –≠—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
            createClickEffect(x, y);
            
            // –ù–∞–ø—Ä–∞–≤–ª—è–µ–º –º–µ—Ç–µ–æ—Ä—ã –∫ —Ç–æ—á–∫–µ –∫–ª–∏–∫–∞
            directMeteors(x, y);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ–±—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
            if (GAME.totalClicks === 1) {
                setTimeout(() => {
                    UI.tutorial.classList.add('hidden');
                }, 3000);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            if (GAME.clickStreak > GAME.maxClickStreak) {
                GAME.maxClickStreak = GAME.clickStreak;
            }
        }

        function updateCombo() {
            // –ö–æ–º–±–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –∫–ª–∏–∫–∞—Ö
            if (GAME.clickStreak > 10) {
                GAME.combo = 1.0 + (GAME.clickStreak / 20);
            } else {
                GAME.combo = 1.0;
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–º–±–æ
            if (GAME.combo > 1.5) {
                UI.comboDisplay.textContent = `${GAME.combo.toFixed(1)}x COMBO!`;
                UI.comboDisplay.style.fontSize = `${Math.min(72, 24 + GAME.combo * 10)}px`;
                UI.comboDisplay.style.opacity = '1';
                
                setTimeout(() => {
                    UI.comboDisplay.style.opacity = '0';
                }, 500);
            }
        }

        function createClickEffect(x, y) {
            UI.clickEffect.style.left = `${x}px`;
            UI.clickEffect.style.top = `${y}px`;
            UI.clickEffect.style.width = '0px';
            UI.clickEffect.style.height = '0px';
            UI.clickEffect.style.opacity = '1';
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            setTimeout(() => {
                UI.clickEffect.style.width = '100px';
                UI.clickEffect.style.height = '100px';
                UI.clickEffect.style.opacity = '0';
            }, 10);
        }

        function directMeteors(targetX, targetY) {
            const speedMultiplier = 1.0 + (GAME.clickRate - 1.0) * 0.5;
            
            METEORS.forEach(meteor => {
                const dx = targetX - meteor.x;
                const dy = targetY - meteor.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 0) {
                    // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Å —É—á–µ—Ç–æ–º —É–ª—É—á—à–µ–Ω–∏–π
                    const baseSpeed = meteor.speed * (1 + (UPGRADES.speed.level - 1) * UPGRADES.speed.effect);
                    
                    // –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç –∫–ª–∏–∫–æ–≤
                    const clickSpeed = baseSpeed * speedMultiplier;
                    
                    // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –Ω–µ–±–æ–ª—å—à–∏–º —Ä–∞–∑–±—Ä–æ—Å–æ–º –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
                    const angle = Math.atan2(dy, dx) + (Math.random() - 0.5) * 0.2;
                    
                    meteor.vx = Math.cos(angle) * clickSpeed;
                    meteor.vy = Math.sin(angle) * clickSpeed;
                    meteor.targetX = targetX;
                    meteor.targetY = targetY;
                }
            });
        }

        // -----------------------------------------------------------------
        // 6. –°–ò–°–¢–ï–ú–ê –ú–ï–¢–ï–û–†–ò–¢–û–í
        // -----------------------------------------------------------------
        function spawnMeteor() {
            const types = [
                { size: 20, color: "#e74c3c", speed: 2, health: 50 }, // –ö—Ä–∞—Å–Ω—ã–π
                { size: 25, color: "#3498db", speed: 1.8, health: 75 }, // –°–∏–Ω–∏–π
                { size: 30, color: "#2ecc71", speed: 1.5, health: 100 }, // –ó–µ–ª–µ–Ω—ã–π
                { size: 35, color: "#f1c40f", speed: 1.2, health: 150 }, // –ñ–µ–ª—Ç—ã–π
                { size: 40, color: "#9b59b6", speed: 1.0, health: 200 } // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
            ];
            
            const type = types[Math.floor(Math.random() * types.length)];
            const angle = Math.random() * Math.PI * 2;
            const distance = Math.max(CANVAS.width, CANVAS.height) * 0.6;
            
            const meteor = {
                x: GAME.spawnPosition.x + Math.cos(angle) * distance,
                y: GAME.spawnPosition.y + Math.sin(angle) * distance,
                size: type.size,
                color: type.color,
                speed: type.speed,
                health: type.health,
                maxHealth: type.health,
                vx: 0,
                vy: 0,
                rotation: Math.random() * Math.PI * 2,
                rotationSpeed: (Math.random() - 0.5) * 0.05,
                trail: [],
                type: "normal",
                damage: 10 * (1 + (UPGRADES.damage.level - 1) * UPGRADES.damage.effect)
            };
            
            METEORS.push(meteor);
            GAME.meteorCount++;
        }

        function updateMeteors() {
            for (let i = METEORS.length - 1; i >= 0; i--) {
                const meteor = METEORS[i];
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
                meteor.x += meteor.vx;
                meteor.y += meteor.vy;
                meteor.rotation += meteor.rotationSpeed;
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–ª–µ–¥
                meteor.trail.push({ x: meteor.x, y: meteor.y });
                if (meteor.trail.length > 15) {
                    meteor.trail.shift();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±–æ—Å—Å–æ–º
                if (GAME.currentBoss && checkCollision(meteor, GAME.currentBoss)) {
                    // –ù–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –±–æ—Å—Å—É
                    const damage = meteor.damage * GAME.combo;
                    GAME.currentBoss.health -= damage;
                    
                    // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
                    createHitEffect(meteor.x, meteor.y, meteor.color, damage);
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞
                    METEORS.splice(i, 1);
                    GAME.meteorCount--;
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–∫–æ–≤
                    GAME.score += Math.floor(damage * 10);
                    
                    continue;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å–Ω–∞—Ä—è–¥–∞–º–∏
                for (let j = PROJECTILES.length - 1; j >= 0; j--) {
                    const projectile = PROJECTILES[j];
                    
                    if (checkCollision(meteor, projectile)) {
                        // –£—Ä–æ–Ω –º–µ—Ç–µ–æ—Ä–∏—Ç—É
                        meteor.health -= projectile.damage;
                        
                        // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
                        createParticles(meteor.x, meteor.y, 10, projectile.color);
                        
                        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–Ω–∞—Ä—è–¥–∞
                        PROJECTILES.splice(j, 1);
                        
                        if (meteor.health <= 0) {
                            // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞
                            createExplosion(meteor.x, meteor.y, meteor.color);
                            METEORS.splice(i, 1);
                            GAME.meteorCount--;
                            GAME.meteorsDestroyed++;
                            
                            // –®—Ç—Ä–∞—Ñ –∑–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞
                            GAME.score = Math.max(0, GAME.score - 50);
                            GAME.combo = Math.max(1, GAME.combo * 0.8);
                            
                            break;
                        }
                    }
                }
                
                // –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–ª–µ–∫–æ —É–ª–µ—Ç–µ–≤—à–∏—Ö –º–µ—Ç–µ–æ—Ä–∏—Ç–æ–≤
                const dx = meteor.x - GAME.spawnPosition.x;
                const dy = meteor.y - GAME.spawnPosition.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > Math.max(CANVAS.width, CANVAS.height) * 0.8) {
                    METEORS.splice(i, 1);
                    GAME.meteorCount--;
                }
            }
        }

        function checkCollision(obj1, obj2) {
            const dx = obj1.x - obj2.x;
            const dy = obj1.y - obj2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            const radius1 = obj1.size || obj1.radius || 0;
            const radius2 = obj2.size || obj2.radius || 0;
            
            return distance < radius1 + radius2;
        }

        // -----------------------------------------------------------------
        // 7. –°–ò–°–¢–ï–ú–ê –ë–û–°–°–û–í
        // -----------------------------------------------------------------
        function spawnBoss() {
            // –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –±–æ—Å—Å–∞
            const bossKeys = Object.keys(BOSS_TYPES);
            const bossType = BOSS_TYPES[bossKeys[Math.floor(Math.random() * bossKeys.length)]];
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Å—Å–∞
            GAME.currentBoss = {
                ...bossType,
                x: CANVAS.width / 2,
                y: 200,
                health: bossType.health * (1 + GAME.bossesDefeated * 0.2), // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è —Å –∫–∞–∂–¥—ã–º –±–æ—Å—Å–æ–º
                maxHealth: bossType.health * (1 + GAME.bossesDefeated * 0.2),
                currentPhase: 0,
                abilityTimers: bossType.abilities.map(() => 0),
                invulnerable: false,
                deathAnimation: false
            };
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç—Ä–æ –±–æ—Å—Å–∞
            showBossIntro(GAME.currentBoss);
            
            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–æ—Å—Å–∞
            UI.bossHealth.style.display = 'block';
            UI.bossName.textContent = GAME.currentBoss.name;
            
            GAME.bossActive = true;
            GAME.phase++;
        }

        function updateBoss() {
            if (!GAME.currentBoss || !GAME.bossActive) return;
            
            const boss = GAME.currentBoss;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
            updateBossMovement(boss);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
            updateBossAbilities(boss);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–∑
            updateBossPhases(boss);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
            updateBossHealth(boss);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–º–µ—Ä—Ç–∏
            if (boss.health <= 0 && !boss.deathAnimation) {
                defeatBoss(boss);
            }
        }

        function updateBossMovement(boss) {
            // –ü–∞—Ç—Ä—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
            boss.x += Math.sin(GAME.gameTime * 0.01) * boss.speed;
            boss.y += Math.cos(GAME.gameTime * 0.02) * boss.speed * 0.5;
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞
            boss.x = Math.max(boss.size, Math.min(CANVAS.width - boss.size, boss.x));
            boss.y = Math.max(boss.size, Math.min(CANVAS.height * 0.4, boss.y));
        }

        function updateBossAbilities(boss) {
            boss.abilities.forEach((ability, index) => {
                boss.abilityTimers[index]++;
                
                if (boss.abilityTimers[index] >= ability.cooldown) {
                    ability.execute(boss);
                    boss.abilityTimers[index] = 0;
                    
                    // –≠—Ñ—Ñ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
                    createParticles(boss.x, boss.y, 20, boss.color);
                }
            });
        }

        function updateBossPhases(boss) {
            const phase = boss.phases[boss.currentPhase];
            
            if (phase && boss.health / boss.maxHealth <= phase.healthThreshold) {
                // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–æ–≤–æ–π —Ñ–∞–∑—ã
                boss.currentPhase++;
                UI.phaseNumber.textContent = boss.currentPhase + 1;
                
                // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ —Ñ–∞–∑—ã
                createPhaseTransition(boss);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∞–∑—ã
                updatePhaseAbilities(boss, phase);
            }
        }

        function updateBossHealth(boss) {
            const healthPercent = (boss.health / boss.maxHealth) * 100;
            UI.bossHealthFill.style.width = `${healthPercent}%`;
            UI.bossHealthText.textContent = `${Math.round(healthPercent)}%`;
            
            // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∑–¥–æ—Ä–æ–≤—å–µ
            if (healthPercent < 30) {
                UI.warningOverlay.style.opacity = '0.3';
            } else {
                UI.warningOverlay.style.opacity = '0';
            }
        }

        function defeatBoss(boss) {
            boss.deathAnimation = true;
            
            // –≠—Ñ—Ñ–µ–∫—Ç —Å–º–µ—Ä—Ç–∏
            createDeathEffect(boss);
            
            // –ù–∞–≥—Ä–∞–¥–∞
            const reward = boss.maxHealth * 10;
            GAME.score += reward;
            GAME.bossesDefeated++;
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            unlockAchievement(`defeat_${boss.name.toLowerCase().replace(/\s+/g, '_')}`, `Defeated ${boss.name}`);
            
            // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ
            showMessage(`Boss Defeated! +${reward} points`);
            
            // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –±–æ—Å—Å–æ–º
            setTimeout(() => {
                GAME.bossActive = false;
                GAME.currentBoss = null;
                UI.bossHealth.style.display = 'none';
                
                // –°–ª–µ–¥—É—é—â–∏–π –±–æ—Å—Å —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
                setTimeout(spawnBoss, 10000);
            }, 3000);
        }

        // -----------------------------------------------------------------
        // 8. –°–ü–û–°–û–ë–ù–û–°–¢–ò –ò–ì–†–û–ö–ê
        // -----------------------------------------------------------------
        function activateAbility(abilityName) {
            const ability = ABILITIES[abilityName];
            const now = Date.now();
            
            if (now - ability.lastUsed < ability.cooldown) return;
            
            ability.lastUsed = now;
            ability.active = true;
            
            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
            switch(abilityName) {
                case 'timeWarp':
                    activateTimeWarp();
                    break;
                case 'meteorRain':
                    activateMeteorRain();
                    break;
                case 'shield':
                    activateShield();
                    break;
                case 'supernova':
                    activateSupernova();
                    break;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateAbilityUI(abilityName);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è
            if (ability.activeTime) {
                setTimeout(() => {
                    ability.active = false;
                }, ability.activeTime);
            }
        }

        function activateTimeWarp() {
            // –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤—Ä–∞–≥–æ–≤
            EFFECTS.push({
                type: "timeWarp",
                duration: 5000,
                speedMultiplier: 0.3
            });
            
            // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            createTimeWarpEffect();
        }

        function activateMeteorRain() {
            // –°–ø–∞—É–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–µ–æ—Ä–∏—Ç–æ–≤
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    spawnMeteor();
                }, i * 100);
            }
            
            // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            createMeteor
function activateShield() {
    // –©–∏—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞
    EFFECTS.push({
        type: "shield",
        duration: 10000,
        damageReduction: 0.5
    });
    
    // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
    createShieldEffect();
}

function activateSupernova() {
    // –ú–æ—â–Ω—ã–π –≤–∑—Ä—ã–≤, —É–Ω–∏—á—Ç–æ–∂–∞—é—â–∏–π –º–µ—Ç–µ–æ—Ä–∏—Ç—ã –∏ –Ω–∞–Ω–æ—Å—è—â–∏–π —É—Ä–æ–Ω –±–æ—Å—Å—É
    const explosionRadius = 300;
    
    // –£—Ä–æ–Ω –±–æ—Å—Å—É
    if (GAME.currentBoss) {
        const dx = GAME.currentBoss.x - GAME.spawnPosition.x;
        const dy = GAME.currentBoss.y - GAME.spawnPosition.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < explosionRadius + GAME.currentBoss.size) {
            const damage = 500 * GAME.combo;
            GAME.currentBoss.health -= damage;
            createHitEffect(GAME.currentBoss.x, GAME.currentBoss.y, "#ffffff", damage);
        }
    }
    
    // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –º–µ—Ç–µ–æ—Ä–∏—Ç–æ–≤ –≤ —Ä–∞–¥–∏—É—Å–µ
    for (let i = METEORS.length - 1; i >= 0; i--) {
        const meteor = METEORS[i];
        const dx = meteor.x - GAME.spawnPosition.x;
        const dy = meteor.y - GAME.spawnPosition.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < explosionRadius) {
            // –í–∑—Ä—ã–≤ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞
            createExplosion(meteor.x, meteor.y, meteor.color);
            METEORS.splice(i, 1);
            GAME.meteorCount--;
            GAME.meteorsDestroyed++;
            
            // –ë–æ–Ω—É—Å–Ω—ã–µ –æ—á–∫–∏
            GAME.score += 100;
        }
    }
    
    // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —Å—É–ø–µ—Ä–Ω–æ–≤—ã
    createSupernovaEffect();
}

function updateAbilityUI(abilityName) {
    const ability = ABILITIES[abilityName];
    const button = ability.element;
    const cooldownElement = button.querySelector('.ability-cooldown');
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    button.classList.add('pulse');
    setTimeout(() => button.classList.remove('pulse'), 1000);
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∫—É–ª–¥–∞—É–Ω
    const startTime = Date.now();
    const updateCooldown = () => {
        const elapsed = Date.now() - startTime;
        const remaining = Math.max(0, ability.cooldown - elapsed);
        
        if (remaining > 0) {
            const seconds = Math.ceil(remaining / 1000);
            cooldownElement.textContent = seconds;
            cooldownElement.style.display = 'flex';
            
            button.classList.add('disabled');
            requestAnimationFrame(updateCooldown);
        } else {
            cooldownElement.style.display = 'none';
            button.classList.remove('disabled');
        }
    };
    
    updateCooldown();
}

// -----------------------------------------------------------------
// 9. –í–ò–ó–£–ê–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ –ò –ß–ê–°–¢–ò–¶–´
// -----------------------------------------------------------------
function createTimeWarpEffect() {
    // –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ö—Ä–µ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
    for (let i = 0; i < 50; i++) {
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.random() * 200;
        
        UI.particleContainer.innerHTML += `
            <div class="time-warp-particle" style="
                position: absolute;
                left: ${GAME.spawnPosition.x + Math.cos(angle) * distance}px;
                top: ${GAME.spawnPosition.y + Math.sin(angle) * distance}px;
                width: 4px;
                height: 4px;
                background: #3498db;
                border-radius: 50%;
                animation: spiral 2s linear infinite;
                opacity: 0.7;
            "></div>
        `;
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏—Ü —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
    setTimeout(() => {
        const particles = document.querySelectorAll('.time-warp-particle');
        particles.forEach(p => p.remove());
    }, 2000);
}

function createMeteorRainEffect() {
    // –≠—Ñ—Ñ–µ–∫—Ç –º–µ—Ç–µ–æ—Ä–∏—Ç–Ω–æ–≥–æ –¥–æ–∂–¥—è
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const x = Math.random() * CANVAS.width;
            const y = -50;
            
            UI.particleContainer.innerHTML += `
                <div class="meteor-rain" style="
                    position: absolute;
                    left: ${x}px;
                    top: ${y}px;
                    width: 8px;
                    height: 30px;
                    background: linear-gradient(to bottom, #f39c12, #e74c3c);
                    border-radius: 4px;
                    animation: fall 1s linear forwards;
                    box-shadow: 0 0 10px #f39c12;
                "></div>
            `;
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                const meteors = document.querySelectorAll('.meteor-rain');
                if (meteors.length > 0) meteors[0].remove();
            }, 1000);
        }, i * 50);
    }
}

function createShieldEffect() {
    // –°–æ–∑–¥–∞–Ω–∏–µ —â–∏—Ç–∞ –≤–æ–∫—Ä—É–≥ —Ü–µ–Ω—Ç—Ä–∞
    const shield = document.createElement('div');
    shield.className = 'shield-effect';
    shield.style.cssText = `
        position: absolute;
        left: ${GAME.spawnPosition.x - 150}px;
        top: ${GAME.spawnPosition.y - 150}px;
        width: 300px;
        height: 300px;
        border: 3px solid #3498db;
        border-radius: 50%;
        animation: shield-pulse 0.5s infinite alternate;
        opacity: 0.7;
        pointer-events: none;
        z-index: 90;
    `;
    
    UI.particleContainer.appendChild(shield);
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —â–∏—Ç–∞ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
    setTimeout(() => {
        if (shield.parentNode) {
            shield.parentNode.removeChild(shield);
        }
    }, 10000);
}

function createSupernovaEffect() {
    // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å—É–ø–µ—Ä–Ω–æ–≤—ã
    const supernova = document.createElement('div');
    supernova.className = 'supernova-effect';
    supernova.style.cssText = `
        position: absolute;
        left: ${GAME.spawnPosition.x}px;
        top: ${GAME.spawnPosition.y}px;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: radial-gradient(circle, #f1c40f 0%, #e74c3c 50%, transparent 70%);
        transform: translate(-50%, -50%);
        animation: supernova-explode 0.8s forwards;
        pointer-events: none;
        z-index: 100;
    `;
    
    UI.particleContainer.appendChild(supernova);
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
    setTimeout(() => {
        if (supernova.parentNode) {
            supernova.parentNode.removeChild(supernova);
        }
    }, 1000);
}

function createHitEffect(x, y, color, damage) {
    // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è
    const hit = document.createElement('div');
    hit.className = 'hit-effect';
    hit.style.cssText = `
        position: absolute;
        left: ${x}px;
        top: ${y}px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: radial-gradient(circle, ${color} 0%, transparent 70%);
        transform: translate(-50%, -50%);
        animation: hit-pulse 0.3s forwards;
        pointer-events: none;
        z-index: 110;
    `;
    
    UI.particleContainer.appendChild(hit);
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —É—Ä–æ–Ω
    showDamageNumber(x, y, Math.floor(damage));
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
    setTimeout(() => {
        if (hit.parentNode) {
            hit.parentNode.removeChild(hit);
        }
    }, 300);
}

function createExplosion(x, y, color) {
    // –°–æ–∑–¥–∞–Ω–∏–µ –≤–∑—Ä—ã–≤–∞
    for (let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.random() * 50 + 30;
        const size = Math.random() * 8 + 4;
        
        particle.style.cssText = `
            position: absolute;
            left: ${x}px;
            top: ${y}px;
            width: ${size}px;
            height: ${size}px;
            background: ${color};
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: explode 0.8s forwards;
            opacity: 0.8;
            pointer-events: none;
            z-index: 105;
        `;
        
        // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
        particle.animate([
            {
                transform: `translate(-50%, -50%) translate(0, 0)`,
                opacity: 1
            },
            {
                transform: `translate(-50%, -50%) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`,
                opacity: 0
            }
        ], {
            duration: 800,
            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
        });
        
        UI.particleContainer.appendChild(particle);
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
        setTimeout(() => {
            if (particle.parentNode) {
                particle.parentNode.removeChild(particle);
            }
        }, 800);
    }
}

function createPhaseTransition(boss) {
    // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ —Ñ–∞–∑—ã
    UI.warningOverlay.style.opacity = '0.5';
    document.body.classList.add('shake');
    
    // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const angle = Math.random() * Math.PI * 2;
            const distance = boss.size + Math.random() * 100;
            
            createParticles(
                boss.x + Math.cos(angle) * distance,
                boss.y + Math.sin(angle) * distance,
                5,
                boss.color
            );
        }, i * 50);
    }
    
    // –£–±—Ä–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
    setTimeout(() => {
        UI.warningOverlay.style.opacity = '0';
        document.body.classList.remove('shake');
    }, 1000);
}

function createDeathEffect(boss) {
    // –≠—Ñ—Ñ–µ–∫—Ç —Å–º–µ—Ä—Ç–∏ –±–æ—Å—Å–∞
    const particlesCount = 50;
    
    for (let i = 0; i < particlesCount; i++) {
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.random() * boss.size;
        const size = Math.random() * 15 + 5;
        
        const particle = document.createElement('div');
        particle.style.cssText = `
            position: absolute;
            left: ${boss.x + Math.cos(angle) * distance}px;
            top: ${boss.y + Math.sin(angle) * distance}px;
            width: ${size}px;
            height: ${size}px;
            background: ${boss.color};
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 115;
        `;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∞–∑–ª–µ—Ç–∞
        particle.animate([
            {
                transform: `translate(-50%, -50%) scale(1)`,
                opacity: 1
            },
            {
                transform: `translate(-50%, -50%) translate(${Math.cos(angle) * 200}px, ${Math.sin(angle) * 200}px) scale(0)`,
                opacity: 0
            }
        ], {
            duration: 1500,
            easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
        });
        
        UI.particleContainer.appendChild(particle);
        
        // –£–¥–∞–ª–µ–Ω–∏–µ
        setTimeout(() => {
            if (particle.parentNode) particle.parentNode.removeChild(particle);
        }, 1500);
    }
    
    // –ë–æ–ª—å—à–æ–π –≤–∑—Ä—ã–≤ –≤ —Ü–µ–Ω—Ç—Ä–µ
    createExplosion(boss.x, boss.y, boss.color);
}

function createParticles(x, y, count, color) {
    for (let i = 0; i < count; i++) {
        const particle = document.createElement('div');
        const angle = Math.random() * Math.PI * 2;
        const distance = Math.random() * 30;
        const size = Math.random() * 6 + 2;
        
        particle.style.cssText = `
            position: absolute;
            left: ${x}px;
            top: ${y}px;
            width: ${size}px;
            height: ${size}px;
            background: ${color};
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 100;
        `;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è
        particle.animate([
            {
                transform: `translate(-50%, -50%) translate(0, 0)`,
                opacity: 1
            },
            {
                transform: `translate(-50%, -50%) translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`,
                opacity: 0
            }
        ], {
            duration: 600,
            easing: 'ease-out'
        });
        
        UI.particleContainer.appendChild(particle);
        
        // –£–¥–∞–ª–µ–Ω–∏–µ
        setTimeout(() => {
            if (particle.parentNode) particle.parentNode.removeChild(particle);
        }, 600);
    }
}

function showDamageNumber(x, y, damage) {
    const damageNumber = document.createElement('div');
    damageNumber.className = 'damage-number';
    damageNumber.textContent = damage;
    damageNumber.style.left = `${x}px`;
    damageNumber.style.top = `${y}px`;
    
    UI.damageNumbers.appendChild(damageNumber);
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    damageNumber.animate([
        {
            transform: 'translateY(0)',
            opacity: 1
        },
        {
            transform: 'translateY(-50px)',
            opacity: 0
        }
    ], {
        duration: 1000,
        easing: 'ease-out'
    });
    
    // –£–¥–∞–ª–µ–Ω–∏–µ
    setTimeout(() => {
        if (damageNumber.parentNode) {
            damageNumber.parentNode.removeChild(damageNumber);
        }
    }, 1000);
}

// -----------------------------------------------------------------
// 10. –ò–ù–¢–ï–†–§–ï–ô–° –ò –ú–ï–ù–Æ
// -----------------------------------------------------------------
function startNewGame() {
    // –°–±—Ä–æ—Å –∏–≥—Ä—ã
    GAME = {
        running: true,
        paused: false,
        score: 0,
        combo: 1.0,
        clickRate: 1.0,
        baseClickPower: 1.0,
        clickMultiplier: 1.0,
        meteorCount: 0,
        phase: 1,
        wave: 1,
        bossActive: false,
        currentBoss: null,
        bossesDefeated: 0,
        meteorsDestroyed: 0,
        totalClicks: 0,
        clickStreak: 0,
        lastClickTime: 0,
        maxClickStreak: 0,
        gameTime: 0,
        meteorSpawnTimer: 0,
        meteorSpawnDelay: 120,
        spawnPosition: { x: CANVAS.width / 2, y: CANVAS.height / 2 },
        camera: { x: 0, y: 0, zoom: 1 },
        particles: [],
        damageNumbers: [],
        achievements: new Set(),
        upgrades: GAME.upgrades, // –°–æ—Ö—Ä–∞–Ω—è–µ–º —É–ª—É—á—à–µ–Ω–∏—è
        stats: GAME.stats,
        settings: GAME.settings
    };
    
    // –û—á–∏—Å—Ç–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
    METEORS = [];
    BOSSES = [];
    PROJECTILES = [];
    EFFECTS = [];
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    UI.gameMenu.style.display = 'none';
    UI.upgradesPanel.style.display = 'none';
    UI.phaseIndicator.style.display = 'block';
    UI.meteorCounter.style.display = 'block';
    UI.tutorial.style.display = 'block';
    UI.tutorial.classList.remove('hidden');
    
    // –°–ø–∞—É–Ω –ø–µ—Ä–≤–æ–≥–æ –±–æ—Å—Å–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        spawnBoss();
    }, 10000);
    
    // –°—Ç–∞—Ä—Ç–æ–≤–∞—è –≤–æ–ª–Ω–∞ –º–µ—Ç–µ–æ—Ä–∏—Ç–æ–≤
    for (let i = 0; i < 5; i++) {
        setTimeout(() => spawnMeteor(), i * 500);
    }
    
    console.log("New game started!");
}

function continueGame() {
    GAME.running = true;
    GAME.paused = false;
    UI.gameMenu.style.display = 'none';
    UI.upgradesPanel.style.display = 'none';
    UI.phaseIndicator.style.display = 'block';
    UI.meteorCounter.style.display = 'block';
    
    console.log("Game continued from save");
}

function toggleUpgrades() {
    if (UI.upgradesPanel.style.display === 'none' || UI.upgradesPanel.style.display === '') {
        UI.upgradesPanel.style.display = 'block';
        updateUpgradesUI();
    } else {
        UI.upgradesPanel.style.display = 'none';
    }
}

function showStats() {
    const statsHTML = `
        <div style="text-align: left; margin: 20px 0;">
            <h3 style="color: #3498db; margin-bottom: 15px;">Game Statistics</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div style="color: #95a5a6;">Total Score:</div>
                <div style="color: #f1c40f; font-weight: bold;">${GAME.stats.totalScore.toLocaleString()}</div>
                
                <div style="color: #95a5a6;">Bosses Defeated:</div>
                <div style="color: #e74c3c; font-weight: bold;">${GAME.stats.totalBosses}</div>
                
                <div style="color: #95a5a6;">Meteors Destroyed:</div>
                <div style="color: #2ecc71; font-weight: bold;">${GAME.stats.totalMeteors.toLocaleString()}</div>
                
                <div style="color: #95a5a6;">Total Clicks:</div>
                <div style="color: #9b59b6; font-weight: bold;">${GAME.stats.totalClicks.toLocaleString()}</div>
                
                <div style="color: #95a5a6;">Play Time:</div>
                <div style="color: #1abc9c; font-weight: bold;">${formatTime(GAME.stats.playTime)}</div>
                
                <div style="color: #95a5a6;">Highest Combo:</div>
                <div style="color: #f39c12; font-weight: bold;">${GAME.stats.highestCombo.toFixed(1)}x</div>
                
                <div style="color: #95a5a6;">Highest Click Rate:</div>
                <div style="color: #3498db; font-weight: bold;">${GAME.stats.highestClickRate.toFixed(1)}/s</div>
            </div>
        </div>
    `;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –º–µ–Ω—é
    const statsPanel = document.createElement('div');
    statsPanel.innerHTML = statsHTML;
    
    // –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    alert(`Game Statistics:\n\n` +
          `Total Score: ${GAME.stats.totalScore.toLocaleString()}\n` +
          `Bosses Defeated: ${GAME.stats.totalBosses}\n` +
          `Meteors Destroyed: ${GAME.stats.totalMeteors.toLocaleString()}\n` +
          `Total Clicks: ${GAME.stats.totalClicks.toLocaleString()}\n` +
          `Play Time: ${formatTime(GAME.stats.playTime)}\n` +
          `Highest Combo: ${GAME.stats.highestCombo.toFixed(1)}x\n` +
          `Highest Click Rate: ${GAME.stats.highestClickRate.toFixed(1)}/s`);
}

function formatTime(seconds) {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const secs = Math.floor(seconds % 60);
    
    if (hours > 0) {
        return `${hours}h ${minutes}m ${secs}s`;
    } else if (minutes > 0) {
        return `${minutes}m ${secs}s`;
    } else {
        return `${secs}s`;
    }
}

function updateUI() {
    UI.score.textContent = GAME.score.toLocaleString();
    UI.combo.textContent = GAME.combo.toFixed(1) + 'x';
    UI.clickRate.textContent = GAME.clickRate.toFixed(1);
    UI.meteorCount.textContent = GAME.meteorCount;
    UI.phaseNumber.textContent = GAME.phase;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    if (GAME.combo > GAME.stats.highestCombo) {
        GAME.stats.highestCombo = GAME.combo;
    }
    
    if (GAME.clickRate > GAME.stats.highestClickRate) {
        GAME.stats.highestClickRate = GAME.clickRate;
    }
}

function updateUpgradesUI() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ —É—Ä–æ–≤–Ω–µ–π —É–ª—É—á—à–µ–Ω–∏–π
    for (const [key, upgrade] of Object.entries(UPGRADES)) {
        const level = GAME.upgrades[key] || 1;
        const cost = Math.floor(upgrade.cost * Math.pow(upgrade.costMultiplier, level - 1));
        
        upgrade.element.querySelector('.upgrade-cost').textContent = cost;
        upgrade.element.querySelector('.upgrade-level').textContent = `Level: ${level}`;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, –º–æ–∂–Ω–æ –ª–∏ –∫—É–ø–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ
        if (GAME.score >= cost) {
            upgrade.element.style.opacity = '1';
            upgrade.element.style.cursor = 'pointer';
        } else {
            upgrade.element.style.opacity = '0.5';
            upgrade.element.style.cursor = 'not-allowed';
        }
    }
}

function purchaseUpgrade(type) {
    const upgrade = UPGRADES[type];
    const level = GAME.upgrades[type] || 1;
    const cost = Math.floor(upgrade.cost * Math.pow(upgrade.costMultiplier, level - 1));
    
    if (GAME.score >= cost) {
        // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
        GAME.score -= cost;
        GAME.upgrades[type] = level + 1;
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —É–ª—É—á—à–µ–Ω–∏—è
        upgrade.level = GAME.upgrades[type];
        
        // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–∫—É–ø–∫–∏
        upgrade.element.classList.add('float');
        setTimeout(() => upgrade.element.classList.remove('float'), 1000);
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        updateUI();
        updateUpgradesUI();
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        saveGame();
        
        console.log(`Purchased ${type} upgrade to level ${GAME.upgrades[type]}`);
    }
}

function showBossIntro(boss) {
    UI.introBossName.textContent = boss.name;
    UI.introBossDesc.textContent = boss.description;
    UI.introBossAbility.textContent = `Special Ability: ${boss.abilities[0].name}`;
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç—Ä–æ
    UI.bossIntro.style.opacity = '1';
    
    // –°–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        UI.bossIntro.style.opacity = '0';
    }, 3000);
}

function showMessage(text) {
    const message = document.createElement('div');
    message.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(10, 10, 30, 0.9);
        color: #f1c40f;
        padding: 20px 40px;
        border-radius: 10px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        z-index: 200;
        animation: message-popup 1.5s forwards;
    `;
    
    message.textContent = text;
    document.body.appendChild(message);
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è
    setTimeout(() => {
        if (message.parentNode) {
            message.parentNode.removeChild(message);
        }
    }, 1500);
}

function unlockAchievement(id, name) {
    if (!GAME.achievements.has(id)) {
        GAME.achievements.add(id);
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
        UI.achievementToast.querySelector('.achievement-title').textContent = 'Achievement Unlocked!';
        UI.achievementToast.querySelector('.achievement-desc').textContent = name;
        
        UI.achievementToast.style.right = '20px';
        
        // –°–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            UI.achievementToast.style.right = '-400px';
        }, 3000);
        
        console.log(`Achievement unlocked: ${name}`);
    }
}

function togglePause() {
    GAME.paused = !GAME.paused;
    
    if (GAME.paused) {
        showMessage("Game Paused");
    }
}

// -----------------------------------------------------------------
// 11. –û–¢–†–ò–°–û–í–ö–ê –ò–ì–†–´
// -----------------------------------------------------------------
function drawStars() {
    STARS.forEach(star => {
        // –ú–µ—Ä—Ü–∞–Ω–∏–µ –∑–≤—ë–∑–¥
        const twinkle = Math.sin(star.twinkle + GAME.gameTime * 0.01) * 0.3 + 0.7;
        
        CTX.fillStyle = `rgba(255, 255, 255, ${star.brightness * twinkle})`;
        CTX.beginPath();
        CTX.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        CTX.fill();
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è
        star.twinkle += 0.02;
    });
}

function drawMeteors() {
    METEORS.forEach(meteor => {
        // –†–∏—Å—É–µ–º —Å–ª–µ–¥
        for (let i = 0; i < meteor.trail.length; i++) {
            const point = meteor.trail[i];
            const alpha = i / meteor.trail.length * 0.5;
            
            CTX.fillStyle = `${meteor.color}${Math.floor(alpha * 255).toString(16).padStart(2, '0')}`;
            CTX.beginPath();
            CTX.arc(point.x, point.y, meteor.size * (i / meteor.trail.length), 0, Math.PI * 2);
            CTX.fill();
        }
        
        // –†–∏—Å—É–µ–º –º–µ—Ç–µ–æ—Ä–∏—Ç
        CTX.save();
        CTX.translate(meteor.x, meteor.y);
        CTX.rotate(meteor.rotation);
        
        // –û—Å–Ω–æ–≤–Ω–æ–π –∫—Ä—É–≥
        CTX.fillStyle = meteor.color;
        CTX.beginPath();
        CTX.arc(0, 0, meteor.size, 0, Math.PI * 2);
        CTX.fill();
        
        // –î–µ—Ç–∞–ª–∏
        CTX.fillStyle = '#fff';
        CTX.beginPath();
        CTX.arc(meteor.size * 0.3, -meteor.size * 0.3, meteor.size * 0.2, 0, Math.PI * 2);
        CTX.fill();
        
        CTX.restore();
        
        // –ü–æ–ª–æ—Å–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è (–µ—Å–ª–∏ –µ—Å—Ç—å —É—Ä–æ–Ω)
        if (meteor.health < meteor.maxHealth) {
            const healthPercent = meteor.health / meteor.maxHealth;
            
            CTX.fillStyle = '#e74c3c';
            CTX.fillRect(
                meteor.x - meteor.size,
                meteor.y - meteor.size - 10,
                meteor.size * 2,
                4
            );
            
            CTX.fillStyle = '#2ecc71';
            CTX.fillRect(
                meteor.x - meteor.size,
                meteor.y - meteor.size - 10,
                meteor.size * 2 * healthPercent,
                4
            );
        }
    });
}

function drawBoss() {
    if (!GAME.currentBoss) return;
    
    const boss = GAME.currentBoss;
    
    CTX.save();
    CTX.translate(boss.x, boss.y);
    
    // –û—Å–Ω–æ–≤–Ω–æ–µ —Ç–µ–ª–æ –±–æ—Å—Å–∞
    CTX.fillStyle = boss.color;
    CTX.beginPath();
    CTX.arc(0, 0, boss.size, 0, Math.PI * 2);
    CTX.fill();
    
    // –î–µ—Ç–∞–ª–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –±–æ—Å—Å–∞
    switch(boss.name) {
        case "Space Dragon":
            // –ö—Ä—ã–ª—å—è –¥—Ä–∞–∫–æ–Ω–∞
            CTX.fillStyle = '#8e44ad';
            CTX.beginPath();
            CTX.ellipse(-boss.size * 0.8, 0, boss.size * 0.6, boss.size * 0.3, 0, 0, Math.PI * 2);
            CTX.fill();
            CTX.beginPath();
            CTX.ellipse(boss.size * 0.8, 0, boss.size * 0.6, boss.size * 0.3, 0, 0, Math.PI * 2);
            CTX.fill();
            break;
            
        case "Living Planet":
            // –ö–æ–ª—å—Ü–∞ –ø–ª–∞–Ω–µ—Ç—ã
            CTX.strokeStyle = '#27ae60';
            CTX.lineWidth = 3;
            CTX.beginPath();
            CTX.arc(0, 0, boss.size + 20, 0, Math.PI * 2);
            CTX.stroke();
            CTX.beginPath();
            CTX.arc(0, 0, boss.size + 40, 0, Math.PI * 2);
            CTX.stroke();
            break;
            
        case "Solar Giant":
            // –°–æ–ª–Ω–µ—á–Ω—ã–µ –≤—Å–ø—ã—à–∫–∏
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * Math.PI * 2 + GAME.gameTime * 0.01;
                const flareLength = boss.size * 0.5 + Math.sin(GAME.gameTime * 0.05 + i) * 10;
                
                CTX.strokeStyle = '#f1c40f';
                CTX.lineWidth = 4;
                CTX.beginPath();
                CTX.moveTo(
                    Math.cos(angle) * boss.size,
                    Math.sin(angle) * boss.size
                );
                CTX.lineTo(
                    Math.cos(angle) * (boss.size + flareLength),
                    Math.sin(angle) * (boss.size + flareLength)
                );
                CTX.stroke();
            }
            break;
    }
    
    CTX.restore();
}

function drawProjectiles() {
    PROJECTILES.forEach(projectile => {
        CTX.save();
        CTX.translate(projectile.x, projectile.y);
        CTX.rotate(projectile.angle);
        
        // –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Å–Ω–∞—Ä—è–¥–æ–≤
        switch(projectile.type) {
            case "laser":
                CTX.fillStyle = projectile.color;
                CTX.fillRect(-projectile.size, -projectile.size / 2, projectile.size * 2, projectile.size);
                break;
                
            case "fire":
                // –û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä
                const gradient = CTX.createRadialGradient(0, 0, 0, 0, 0, projectile.size);
                gradient.addColorStop(0, '#ffffff');
                gradient.addColorStop(0.5, '#f39c12');
                gradient.addColorStop(1, '#e74c3c');
                
                CTX.fillStyle = gradient;
                CTX.beginPath();
                CTX.arc(0, 0, projectile.size, 0, Math.PI * 2);
                CTX.fill();
                break;
                
            default:
                // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–Ω–∞—Ä—è–¥
                CTX.fillStyle = projectile.color;
                CTX.beginPath();
                CTX.arc(0, 0, projectile.size, 0, Math.PI * 2);
                CTX.fill();
        }
        
        CTX.restore();
        
        // –°–ª–µ–¥ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–Ω–∞—Ä—è–¥–æ–≤
        if (projectile.trail) {
            CTX.fillStyle = `${projectile.color}80`;
            CTX.beginPath();
            CTX.arc(projectile.x, projectile.y, projectile.size * 0.5, 0, Math.PI * 2);
            CTX.fill();
        }
    });
}

function drawEffects() {
    EFFECTS.forEach(effect => {
        switch(effect.type) {
            case "gravity":
                // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞
                const gradient = CTX.createRadialGradient(
                    effect.x, effect.y, 0,
                    effect.x, effect.y, effect.radius
                );
                gradient.addColorStop(0, 'rgba(52, 152, 219, 0.3)');
                gradient.addColorStop(1, 'rgba(52, 152, 219, 0)');
                
                CTX.fillStyle = gradient;
                CTX.beginPath();
                CTX.arc(effect.x, effect.y, effect.radius, 0, Math.PI * 2);
                CTX.fill();
                break;
                
            case "nova":
                // –í–∑—Ä—ã–≤–Ω–∞—è –≤–æ–ª–Ω–∞
                CTX.strokeStyle = `rgba(241, 196, 15, ${1 - effect.radius / effect.maxRadius})`;
                CTX.lineWidth = 3;
                CTX.beginPath();
                CTX.arc(effect.x, effect.y, effect.radius, 0, Math.PI * 2);
                CTX.stroke();
                break;
        }
    });
}

// -----------------------------------------------------------------
// 12. –ò–ì–†–û–í–û–ô –¶–ò–ö–õ
// -----------------------------------------------------------------
let lastTime = 0;
function gameLoop(currentTime) {
    if (!lastTime) lastTime = currentTime;
    const deltaTime = Math.min((currentTime - lastTime) / 16.67, 2); // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ delta time
    lastTime = currentTime;
    
    if (GAME.running && !GAME.paused) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        GAME.gameTime += deltaTime / 60; // –í —Å–µ–∫—É–Ω–¥–∞—Ö
        GAME.stats.playTime += deltaTime / 60;
        
        // –°–ø–∞—É–Ω –º–µ—Ç–µ–æ—Ä–∏—Ç–æ–≤
        GAME.meteorSpawnTimer += deltaTime;
        if (GAME.meteorSpawnTimer >= GAME.meteorSpawnDelay) {
            spawnMeteor();
            GAME.meteorSpawnTimer = 0;
            
            // –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–ø–∞—É–Ω–∞ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
            const spawnUpgrade = (GAME.upgrades.spawn - 1) * UPGRADES.spawn.effect;
            GAME.meteorSpawnDelay = Math.max(30, 120 * (1 - spawnUpgrade));
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
        updateMeteors();
        updateBoss();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–Ω–∞—Ä—è–¥–æ–≤
        updateProjectiles();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
        updateEffects();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        updateUI();
        
        // –°–±—Ä–æ—Å —Å—Ç—Ä–∏–∫–∞ –∫–ª–∏–∫–æ–≤ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –≤—Ä–µ–º—è
        if (Date.now() - GAME.lastClickTime > 1000) {
            GAME.clickStreak = 0;
        }
    }
    
    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
    CTX.clearRect(0, 0, CANVAS.width, CANVAS.height);
    
    // –§–æ–Ω
    CTX.fillStyle = '#0a0a1a';
    CTX.fillRect(0, 0, CANVAS.width, CANVAS.height);
    
    // –ó–≤—ë–∑–¥—ã
    drawStars();
    
    // –û–±—ä–µ–∫—Ç—ã –∏–≥—Ä—ã
    drawEffects();
    drawMeteors();
    drawBoss();
    drawProjectiles();
    
    // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
    requestAnimationFrame(gameLoop);
}

function updateProjectiles() {
    for (let i = PROJECTILES.length - 1; i >= 0; i--) {
        const projectile = PROJECTILES[i];
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
        projectile.x += Math.cos(projectile.angle) * projectile.speed;
        projectile.y += Math.sin(projectile.angle) * projectile.speed;
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã—à–µ–¥—à–∏—Ö –∑–∞ –ø—Ä–µ–¥–µ–ª—ã
        if (projectile.x < -100 || projectile.x > CANVAS.width + 100 ||
            projectile.y < -100 || projectile.y > CANVAS.height + 100) {
            PROJECTILES.splice(i, 1);
            continue;
        }
        
        // –î–æ–º–∞—Ü–∏—è –¥–ª—è —Å–∞–º–æ–Ω–∞–≤–æ–¥—è—â–∏—Ö—Å—è —Å–Ω–∞—Ä—è–¥–æ–≤
        if (projectile.homing && projectile.target) {
            const dx = projectile.target.x - projectile.x;
            const dy = projectile.target.y - projectile.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                const targetAngle = Math.atan2(dy, dx);
                const angleDiff = targetAngle - projectile.angle;
                
                // –ü–ª–∞–≤–Ω–æ–µ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∫ —Ü–µ–ª–∏
                projectile.angle += Math.sin(angleDiff) * 0.1;
            }
        }
        
        // –¢—Ä–µ–∫–∏–Ω–≥ –¥–ª—è —Ä–∞–∫–µ—Ç
        if (projectile.tracking) {
            const dx = projectile.targetX - projectile.x;
            const dy = projectile.targetY - projectile.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > 0) {
                const targetAngle = Math.atan2(dy, dx);
                projectile.angle = targetAngle;
            }
        }
    }
}

function updateEffects() {
    for (let i = EFFECTS.length - 1; i >= 0; i--) {
        const effect = EFFECTS[i];
        
        // –£–º–µ–Ω—å—à–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        if (effect.duration) {
            effect.duration--;
            if (effect.duration <= 0) {
                EFFECTS.splice(i, 1);
                continue;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
        switch(effect.type) {
            case "nova":
            case "eventHorizon":
                // –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤–∑—Ä—ã–≤–Ω–æ–π –≤–æ–ª–Ω—ã
                effect.radius += effect.speed;
                if (effect.radius >= effect.maxRadius) {
                    EFFECTS.splice(i, 1);
                }
                break;
                
            case "gravity":
            case "singularity":
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ –∫ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞–º
                METEORS.forEach(meteor => {
                    const dx = effect.x - meteor.x;
                    const dy = effect.y - meteor.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < effect.radius && distance > 0) {
                        const force = effect.strength / distance;
                        meteor.vx += dx * force;
                        meteor.vy += dy * force;
                    }
                });
                break;
                
            case "repairDrone":
                // –î–≤–∏–∂–µ–Ω–∏–µ –¥—Ä–æ–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞
                effect.x += Math.cos(effect.angle) * effect.speed;
                effect.y += Math.sin(effect.angle) * effect.speed;
                
                // –†–µ–º–æ–Ω—Ç —Ü–µ–ª–∏
                if (effect.target && effect.target.health < effect.target.maxHealth) {
                    effect.target.health += effect.healRate;
                    effect.target.health = Math.min(effect.target.health, effect.target.maxHealth);
                    
                    // –≠—Ñ—Ñ–µ–∫—Ç —Ä–µ–º–æ–Ω—Ç–∞
                    createParticles(effect.x, effect.y, 2, "#2ecc71");
                }
                break;
        }
    }
}

function updatePhaseAbilities(boss, phase) {
    // –£—Å–∏–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∞–∑—ã
    if (phase.speedMultiplier) {
        boss.speed *= phase.speedMultiplier;
    }
    
    if (phase.armor) {
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ (—É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ–º–æ–≥–æ —É—Ä–æ–Ω–∞)
        boss.damageReduction = phase.armor / 100;
    }
    
    if (phase.addsWings) {
        boss.size *= 1.2; // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫—Ä—ã–ª—å–µ–≤
    }
    
    if (phase.enraged) {
        // –Ø—Ä–æ—Å—Ç—å - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∞—Ç–∞–∫
        boss.abilities.forEach(ability => {
            ability.cooldown = Math.floor(ability.cooldown * 0.7);
        });
    }
}

// -----------------------------------------------------------------
// 13. CSS –ê–ù–ò–ú–ê–¶–ò–ò
// -----------------------------------------------------------------
const style = document.createElement('style');
style.textContent = `
    @keyframes spiral {
        0% {
            transform: rotate(0deg) translate(0, 0);
            opacity: 1;
        }
        100% {
            transform: rotate(360deg) translate(100px, 100px);
            opacity: 0;
        }
    }
    
    @keyframes fall {
        0% {
            transform: translateY(0) rotate(0deg);
            opacity: 1;
        }
        100% {
            transform: translateY(${CANVAS.height + 100}px) rotate(360deg);
            opacity: 0;
        }
    }
    
    @keyframes shield-pulse {
        0% {
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
            transform: scale(1);
        }
        100% {
            box-shadow: 0 0 40px rgba(52, 152, 219, 0.8);
            transform: scale(1.05);
        }
    }
    
    @keyframes supernova-explode {
        0% {
            width: 0;
            height: 0;
            opacity: 1;
        }
        100% {
            width: 600px;
            height: 600px;
            opacity: 0;
        }
    }
    
    @keyframes hit-pulse {
        0% {
            transform: translate(-50%, -50%) scale(0.5);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -50%) scale(2);
            opacity: 0;
        }
    }
    
    @keyframes explode {
        0% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -50%) translate(var(--tx, 0), var(--ty, 0)) scale(0);
            opacity: 0;
        }
    }
    
    @keyframes message-popup {
        0% {
            transform: translate(-50%, -50%) scale(0.5);
            opacity: 0;
        }
        50% {
            transform: translate(-50%, -50%) scale(1.1);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
    }
`;
document.head.appendChild(style);

// -----------------------------------------------------------------
// 14. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò –°–¢–ê–†–¢
// -----------------------------------------------------------------
window.addEventListener('load', initGame);

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
window.debug = {
    addScore: (amount) => {
        GAME.score += amount;
        updateUI();
    },
    spawnBoss: () => {
        if (!GAME.bossActive) {
            spawnBoss();
        }
    },
    clearMeteors: () => {
        METEORS = [];
        GAME.meteorCount = 0;
    },
    getStats: () => {
        return {
            score: GAME.score,
            combo: GAME.combo,
            clickRate: GAME.clickRate,
            meteorCount: GAME.meteorCount,
            bossActive: GAME.bossActive,
            bossesDefeated: GAME.bossesDefeated
        };
    }
};

console.log("Meteor Swarm loaded successfully!");
console.log("Debug commands available: debug.addScore(amount), debug.spawnBoss(), debug.clearMeteors(), debug.getStats()");
</script>
