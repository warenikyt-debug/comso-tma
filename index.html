<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZOMBIE APOCALYPSE: –£–ì–ê–†–ù–´–ô –ö–û–®–ú–ê–†</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Papyrus', fantasy;
            user-select: none;
            image-rendering: pixelated;
        }

        body {
            background: #000;
            color: lime;
            overflow: hidden;
            cursor: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><circle cx="16" cy="16" r="14" fill="red"/><text x="10" y="22" fill="white" font-size="12">üíÄ</text></svg>'), auto;
        }

        .container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: radial-gradient(circle, #111 0%, #000 100%);
        }

        .game-area {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            border: 5px dashed #ff00ff;
        }

        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 40px;
            color: yellow;
            text-shadow: 0 0 10px red, 0 0 20px orange;
            z-index: 100;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 15px;
            border: 3px solid #00ffff;
        }

        #timer {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 40px;
            color: #ff00ff;
            z-index: 100;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 15px;
            border: 3px solid yellow;
        }

        .zombie {
            position: absolute;
            transition: all 0.3s;
            filter: hue-rotate(var(--hue));
            z-index: 10;
            transform-origin: center;
        }

        .crazy-zombie {
            animation: spin 2s infinite linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.5); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .player {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 80px;
            z-index: 20;
            transition: transform 0.1s;
            filter: drop-shadow(0 0 10px cyan);
        }

        .projectile {
            position: absolute;
            font-size: 30px;
            z-index: 15;
        }

        .trap {
            position: absolute;
            width: 60px;
            height: 60px;
            background: red;
            border-radius: 50%;
            animation: pulse 1s infinite;
            z-index: 5;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .powerup {
            position: absolute;
            font-size: 40px;
            animation: bounce 1s infinite;
            z-index: 25;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 60px;
            color: red;
            text-align: center;
            z-index: 1000;
            display: none;
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border-radius: 20px;
            border: 5px solid yellow;
            text-shadow: 0 0 20px white;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 100;
        }

        button {
            padding: 15px 30px;
            font-size: 24px;
            background: linear-gradient(45deg, #ff00ff, #00ffff);
            border: none;
            border-radius: 50px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            transform: scale(1.2) rotate(10deg);
            box-shadow: 0 0 30px #ff00ff;
        }

        .absurd-message {
            position: absolute;
            color: yellow;
            font-size: 24px;
            text-shadow: 0 0 10px red;
            z-index: 50;
            pointer-events: none;
            animation: floatUp 2s forwards;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }

        .background-object {
            position: absolute;
            color: #333;
            font-size: 30px;
            z-index: 1;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        .rage-meter {
            position: absolute;
            bottom: 150px;
            left: 20px;
            width: 200px;
            height: 30px;
            background: #333;
            border: 3px solid #ff00ff;
            border-radius: 15px;
            overflow: hidden;
        }

        .rage-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #ffff00, #ff0000);
            width: 0%;
            transition: width 0.5s;
        }

        .inventory {
            position: absolute;
            top: 100px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 15px;
            border: 3px solid #00ffff;
            z-index: 100;
        }

        .item {
            font-size: 30px;
            margin: 5px;
            display: inline-block;
            animation: wiggle 2s infinite;
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(10deg); }
            75% { transform: rotate(-10deg); }
        }

        .chaos-level {
            position: absolute;
            top: 100px;
            right: 20px;
            font-size: 24px;
            color: #ff00ff;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 15px;
            border: 3px solid yellow;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-area" id="gameArea">
            <div id="score">üíÄ –£–±–∏—Ç–æ: 0</div>
            <div id="timer">‚è±Ô∏è 60</div>
            <div class="chaos-level">üåÄ –•–∞–æ—Å: 0%</div>
            <div class="rage-meter">
                <div class="rage-fill" id="rageBar"></div>
            </div>
            <div class="inventory">
                <div>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å:</div>
                <div id="inventory">üçåüåÆüé∏üï∂Ô∏è</div>
            </div>
            
            <div class="player" id="player">ü§™</div>
            
            <div class="message" id="gameOver">
                <div>GAME OVER</div>
                <div style="font-size: 30px;">–ó–æ–º–±–∏ —Å—ä–µ–ª–∏ —Ç–≤–æ–π –º–æ–∑–≥! üß†</div>
                <button onclick="restartGame()">üîÑ –ï–©–Å –†–ê–ó–û–ö!</button>
            </div>
            
            <div class="message" id="levelUp">
                <div>–£–†–û–í–ï–ù–¨ –ü–û–í–´–®–ï–ù!</div>
                <div style="font-size: 30px;">–¢–µ–ø–µ—Ä—å –≤—Å—ë —Å—Ç–∞–ª–æ –ï–©–Å –ë–ï–ó–£–ú–ù–ï–ï! ü§Ø</div>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="shoot('left')">üî´ –í–õ–ï–í–û</button>
            <button onclick="jump()">ü¶ò –ü–†–´–ì–ù–£–¢–¨</button>
            <button onclick="usePowerUp()">‚ú® –°–£–ü–ï–†-–°–ü–û–°–û–ë–ù–û–°–¢–¨</button>
            <button onclick="shoot('right')">üî´ –í–ü–†–ê–í–û</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        if (typeof Telegram !== 'undefined') {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            Telegram.WebApp.setHeaderColor('#000');
            Telegram.WebApp.setBackgroundColor('#000');
        }

        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let score = 0;
        let time = 60;
        let level = 1;
        let rage = 0;
        let chaos = 0;
        let gameActive = true;
        let playerX = 50;
        let isJumping = false;
        let jumpHeight = 0;
        
        // –ë–µ–∑—É–º–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã
        const crazyItems = ['üçå', 'üåÆ', 'üé∏', 'üï∂Ô∏è', 'üé©', 'üêî', 'ü¶Ü', 'üõ∏', 'üßÄ', 'üé≤'];
        let inventory = ['üçå', 'üåÆ', 'üé∏', 'üï∂Ô∏è'];
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const gameArea = document.getElementById('gameArea');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');
        const player = document.getElementById('player');
        const rageBar = document.getElementById('rageBar');
        const inventoryElement = document.getElementById('inventory');
        
        // –ê–±—Å—É—Ä–¥–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        const crazyMessages = [
            "–ó–û–ú–ë–ò –ü–û–î–°–ö–ê–ö–ê–õ! ü¶ò",
            "–ì–†–ê–í–ò–¢–ê–¶–ò–Ø –û–¢–ö–õ–Æ–ß–ï–ù–ê! üöÄ",
            "–í–°–Å –ö–†–£–¢–ò–¢–°–Ø! üåÄ",
            "–¢–´ –ö–¢–û?! ü§î",
            "–ë–ê–ù–ê–ù–ê! üçå",
            "–ù–ò–ß–ï–ì–û –ù–ï –ü–û–ù–ò–ú–ê–Æ! ü§™",
            "–ó–û–ú–ë–ò –¢–ê–ù–¶–£–ï–¢! üíÉ",
            "–í–°–Å –ù–ê–û–ë–û–†–û–¢! üîÑ",
            "–≠–¢–û –ß–¢–û, –°–ù–û–í–ê –¢–´? üëª",
            "–ú–Ø–£? üê±"
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            spawnZombie();
            spawnTrap();
            spawnPowerUp();
            spawnBackgroundObjects();
            
            // –¢–∞–π–º–µ—Ä
            const timer = setInterval(() => {
                if (time > 0 && gameActive) {
                    time--;
                    timerElement.textContent = `‚è±Ô∏è ${time}`;
                    
                    // –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å –±–µ–∑—É–º–∏—è
                    if (time % 10 === 0) {
                        levelUp();
                    }
                    
                    // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
                    if (Math.random() < 0.1) {
                        randomCrazyEvent();
                    }
                } else if (gameActive) {
                    gameOver();
                    clearInterval(timer);
                }
            }, 1000);
            
            // –°–ø–∞–≤–Ω –∑–æ–º–±–∏
            setInterval(() => {
                if (gameActive) {
                    spawnZombie();
                    if (Math.random() < 0.3) spawnZombie();
                    if (chaos > 50 && Math.random() < 0.5) spawnZombie();
                }
            }, 2000 - level * 100);
            
            // –°–ø–∞–≤–Ω –ª–æ–≤—É—à–µ–∫
            setInterval(() => {
                if (gameActive) spawnTrap();
            }, 3000);
            
            // –°–ø–∞–≤–Ω —É–ª—É—á—à–µ–Ω–∏–π
            setInterval(() => {
                if (gameActive) spawnPowerUp();
            }, 5000);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä—ã–∂–∫–∞
            setInterval(updateJump, 50);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–∞–æ—Å–∞
            setInterval(updateChaos, 100);
        }

        // –°–ø–∞–≤–Ω –∑–æ–º–±–∏
        function spawnZombie() {
            const zombie = document.createElement('div');
            zombie.className = 'zombie';
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ç–∏–ø –∑–æ–º–±–∏
            const zombieTypes = ['üßü', 'üßü‚Äç‚ôÇÔ∏è', 'üßü‚Äç‚ôÄÔ∏è', 'ü§ñ', 'üëæ', 'üíÄ', 'üëª', 'ü¶á'];
            const type = zombieTypes[Math.floor(Math.random() * zombieTypes.length)];
            zombie.textContent = type;
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
            const size = 30 + Math.random() * 50;
            zombie.style.fontSize = `${size}px`;
            
            // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
            const x = Math.random() * (window.innerWidth - 100);
            const y = window.innerHeight + 100;
            zombie.style.left = `${x}px`;
            zombie.style.top = `${y}px`;
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
            zombie.style.setProperty('--hue', `${Math.random() * 360}deg`);
            
            // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
            const speed = 1 + Math.random() * 2 + chaos / 100;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –±–µ–∑—É–º–Ω—ã—Ö –∑–æ–º–±–∏
            if (Math.random() < 0.3 + chaos / 200) {
                zombie.classList.add('crazy-zombie');
            }
            
            gameArea.appendChild(zombie);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –∑–æ–º–±–∏
            function moveZombie() {
                if (!gameActive) return;
                
                const currentY = parseFloat(zombie.style.top);
                const currentX = parseFloat(zombie.style.left);
                
                // –ê–±—Å—É—Ä–¥–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
                let newY = currentY - speed;
                let newX = currentX + Math.sin(currentY / 50) * 5;
                
                // –°–ª—É—á–∞–π–Ω—ã–µ —Å–∫–∞—á–∫–∏
                if (Math.random() < 0.05) {
                    newY -= 50;
                    showMessage("–ü–†–´–ì-–°–ö–û–ö!", currentX, currentY);
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫ –∏–≥—Ä–æ–∫—É
                const playerRect = player.getBoundingClientRect();
                const dx = playerRect.left - currentX;
                const dy = playerRect.top - currentY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 300) {
                    newX += (dx / distance) * speed * 2;
                    newY += (dy / distance) * speed * 2;
                }
                
                zombie.style.top = `${newY}px`;
                zombie.style.left = `${newX}px`;
                
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –∏–≥—Ä–æ–∫–æ–º
                if (distance < 50) {
                    takeDamage();
                    zombie.remove();
                }
                
                // –£—Ö–æ–¥ –∑–∞ —ç–∫—Ä–∞–Ω
                if (newY < -100 || newX < -100 || newX > window.innerWidth + 100) {
                    zombie.remove();
                } else {
                    requestAnimationFrame(moveZombie);
                }
            }
            
            moveZombie();
            
            // –ö–ª–∏–∫ –ø–æ –∑–æ–º–±–∏
            zombie.onclick = function(e) {
                e.stopPropagation();
                killZombie(zombie);
            };
        }

        // –£–±–∏–π—Å—Ç–≤–æ –∑–æ–º–±–∏
        function killZombie(zombie) {
            score += Math.floor(1 + chaos / 10);
            scoreElement.textContent = `üíÄ –£–±–∏—Ç–æ: ${score}`;
            
            // –ë–µ–∑—É–º–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
            showMessage(crazyMessages[Math.floor(Math.random() * crazyMessages.length)], 
                       parseFloat(zombie.style.left), 
                       parseFloat(zombie.style.top));
            
            // –í–∑—Ä—ã–≤
            zombie.style.fontSize = '80px';
            zombie.style.opacity = '0.5';
            zombie.style.transition = 'all 0.5s';
            
            setTimeout(() => {
                zombie.remove();
            }, 500);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —è—Ä–æ—Å—Ç—å
            rage = Math.min(100, rage + 5);
            rageBar.style.width = `${rage}%`;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
            if (Math.random() < 0.3) {
                const item = crazyItems[Math.floor(Math.random() * crazyItems.length)];
                if (!inventory.includes(item)) {
                    inventory.push(item);
                    updateInventory();
                    showMessage(`–ù–ê–ô–î–ï–ù: ${item}!`, parseFloat(zombie.style.left), parseFloat(zombie.style.top));
                }
            }
        }

        // –°–ø–∞–≤–Ω –ª–æ–≤—É—à–∫–∏
        function spawnTrap() {
            const trap = document.createElement('div');
            trap.className = 'trap';
            
            const x = Math.random() * (window.innerWidth - 60);
            const y = Math.random() * (window.innerHeight - 60);
            
            trap.style.left = `${x}px`;
            trap.style.top = `${y}px`;
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
            trap.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
            
            gameArea.appendChild(trap);
            
            // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
            setTimeout(() => {
                if (trap.parentNode) {
                    trap.remove();
                }
            }, 5000);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            const checkCollision = setInterval(() => {
                if (!gameActive) {
                    clearInterval(checkCollision);
                    return;
                }
                
                const trapRect = trap.getBoundingClientRect();
                const playerRect = player.getBoundingClientRect();
                
                if (isColliding(trapRect, playerRect)) {
                    showMessage("–õ–û–í–£–®–ö–ê! üí•", x, y);
                    takeDamage();
                    trap.remove();
                    clearInterval(checkCollision);
                }
            }, 100);
        }

        // –°–ø–∞–≤–Ω —É–ª—É—á—à–µ–Ω–∏–π
        function spawnPowerUp() {
            const powerup = document.createElement('div');
            powerup.className = 'powerup';
            
            const powerups = ['‚ú®', '‚ö°', 'üî•', 'üíé', 'üåü', 'üõ°Ô∏è', 'üöÄ', 'üéØ'];
            powerup.textContent = powerups[Math.floor(Math.random() * powerups.length)];
            
            const x = Math.random() * (window.innerWidth - 40);
            const y = Math.random() * (window.innerHeight - 40);
            
            powerup.style.left = `${x}px`;
            powerup.style.top = `${y}px`;
            
            gameArea.appendChild(powerup);
            
            // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
            setTimeout(() => {
                if (powerup.parentNode) {
                    powerup.remove();
                }
            }, 3000);
            
            // –ö–ª–∏–∫ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
            powerup.onclick = function(e) {
                e.stopPropagation();
                collectPowerUp(powerup);
            };
        }

        // –°–±–æ—Ä —É–ª—É—á—à–µ–Ω–∏—è
        function collectPowerUp(powerup) {
            const type = powerup.textContent;
            showMessage(`–°–£–ü–ï–†-–°–ò–õ–ê: ${type}!`, 
                       parseFloat(powerup.style.left), 
                       parseFloat(powerup.style.top));
            
            // –≠—Ñ—Ñ–µ–∫—Ç—ã —É–ª—É—á—à–µ–Ω–∏–π
            switch(type) {
                case '‚ú®':
                    // –í—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç—å
                    player.style.filter = 'drop-shadow(0 0 20px gold)';
                    setTimeout(() => player.style.filter = 'drop-shadow(0 0 10px cyan)', 5000);
                    break;
                case '‚ö°':
                    // –£—Å–∫–æ—Ä–µ–Ω–∏–µ
                    time += 10;
                    break;
                case 'üî•':
                    // –£—Ä–æ–Ω –≤—Å–µ–º –∑–æ–º–±–∏
                    document.querySelectorAll('.zombie').forEach(zombie => {
                        killZombie(zombie);
                    });
                    break;
                case 'üíé':
                    // –ú–Ω–æ–≥–æ –æ—á–∫–æ–≤
                    score += 100;
                    scoreElement.textContent = `üíÄ –£–±–∏—Ç–æ: ${score}`;
                    break;
            }
            
            powerup.remove();
        }

        // –ü—Ä—ã–∂–æ–∫
        function jump() {
            if (!isJumping && gameActive) {
                isJumping = true;
                jumpHeight = 0;
                player.textContent = 'ü¶ò'; // –ú–µ–Ω—è–µ–º –Ω–∞ –∫–µ–Ω–≥—É—Ä—É!
                
                // –°–ª—É—á–∞–π–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –ø—Ä—ã–∂–∫–µ
                if (Math.random() < 0.3) {
                    showMessage("–ü–†–´–ì-–ü–†–´–ì!", playerX, window.innerHeight - 100);
                    // –°–ª—É—á–∞–π–Ω–æ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º
                    if (Math.random() < 0.2) {
                        playerX = Math.random() * (window.innerWidth - 100);
                        updatePlayerPosition();
                    }
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä—ã–∂–∫–∞
        function updateJump() {
            if (isJumping) {
                jumpHeight += 5;
                if (jumpHeight > 100) {
                    jumpHeight = 100;
                    setTimeout(() => {
                        isJumping = false;
                        jumpHeight = 0;
                        player.textContent = 'ü§™';
                    }, 300);
                }
                updatePlayerPosition();
            }
        }

        // –°—Ç—Ä–µ–ª—å–±–∞
        function shoot(direction) {
            if (!gameActive) return;
            
            const projectile = document.createElement('div');
            projectile.className = 'projectile';
            
            // –ê–±—Å—É—Ä–¥–Ω—ã–µ —Å–Ω–∞—Ä—è–¥—ã
            const projectiles = ['üí©', 'üçï', 'üéµ', 'üì¶', 'üß¶', 'üê†', 'üåµ', 'üç©'];
            projectile.textContent = projectiles[Math.floor(Math.random() * projectiles.length)];
            
            const startX = playerX + 40;
            const startY = window.innerHeight - 150 - jumpHeight;
            
            projectile.style.left = `${startX}px`;
            projectile.style.top = `${startY}px`;
            
            gameArea.appendChild(projectile);
            
            // –î–≤–∏–∂–µ–Ω–∏–µ —Å–Ω–∞—Ä—è–¥–∞
            let x = startX;
            const y = startY;
            const speed = 10;
            const dir = direction === 'left' ? -1 : 1;
            
            function moveProjectile() {
                if (!gameActive) {
                    projectile.remove();
                    return;
                }
                
                x += speed * dir;
                projectile.style.left = `${x}px`;
                
                // –í—Ä–∞—â–µ–Ω–∏–µ
                projectile.style.transform = `rotate(${x}deg)`;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
                document.querySelectorAll('.zombie').forEach(zombie => {
                    const zombieRect = zombie.getBoundingClientRect();
                    const projRect = projectile.getBoundingClientRect();
                    
                    if (isColliding(zombieRect, projRect)) {
                        killZombie(zombie);
                        projectile.remove();
                        return;
                    }
                });
                
                // –£—Ö–æ–¥ –∑–∞ —ç–∫—Ä–∞–Ω
                if (x < -50 || x > window.innerWidth + 50) {
                    projectile.remove();
                } else {
                    requestAnimationFrame(moveProjectile);
                }
            }
            
            moveProjectile();
            
            // –ó–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç (–≤ –∫–æ–Ω—Å–æ–ª–∏)
            console.log("Pew! Pew! " + projectile.textContent);
        }

        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É–ø–µ—Ä-—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
        function usePowerUp() {
            if (rage >= 50 && gameActive) {
                rage = 0;
                rageBar.style.width = '0%';
                
                // –°–ª—É—á–∞–π–Ω–∞—è —Å—É–ø–µ—Ä-—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
                const powers = [
                    () => { // –ì–∏–≥–∞–Ω—Ç—Å–∫–∏–π –ø—Ä—ã–∂–æ–∫
                        isJumping = true;
                        jumpHeight = 200;
                        showMessage("–ú–ï–ì–ê-–ü–†–´–ñ–û–ö! üöÄ", playerX, window.innerHeight - 100);
                    },
                    () => { // –í—Ä–∞—â–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
                        gameArea.style.transform = 'rotate(180deg)';
                        setTimeout(() => gameArea.style.transform = 'rotate(0deg)', 3000);
                        showMessage("–í–°–Å –ö–†–£–¢–ò–¢–°–Ø! üå™Ô∏è", window.innerWidth/2, window.innerHeight/2);
                    },
                    () => { // –ö–ª–æ–Ω—ã –∏–≥—Ä–æ–∫–∞
                        for (let i = 0; i < 3; i++) {
                            setTimeout(() => {
                                const clone = document.createElement('div');
                                clone.textContent = 'üë•';
                                clone.style.position = 'absolute';
                                clone.style.fontSize = '80px';
                                clone.style.left = `${Math.random() * window.innerWidth}px`;
                                clone.style.bottom = '100px';
                                gameArea.appendChild(clone);
                                setTimeout(() => clone.remove(), 2000);
                            }, i * 500);
                        }
                    },
                    () => { // –í—Ä–µ–º—è –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è
                        showMessage("–°–õ–û–û–û–û–û–û–û–û–û–û... ‚è≥", window.innerWidth/2, window.innerHeight/2);
                    }
                ];
                
                powers[Math.floor(Math.random() * powers.length)]();
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                if (inventory.length > 0) {
                    const usedItem = inventory.pop();
                    updateInventory();
                    showMessage(`–ò–°–ü–û–õ–¨–ó–û–í–ê–ù: ${usedItem}`, playerX, window.innerHeight - 100);
                }
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
        function isColliding(rect1, rect2) {
            return !(rect1.right < rect2.left || 
                    rect1.left > rect2.right || 
                    rect1.bottom < rect2.top || 
                    rect1.top > rect2.bottom);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
        function takeDamage() {
            if (!gameActive) return;
            
            score = Math.max(0, score - 10);
            scoreElement.textContent = `üíÄ –£–±–∏—Ç–æ: ${score}`;
            
            player.textContent = 'ü§ï';
            player.style.filter = 'drop-shadow(0 0 20px red)';
            
            setTimeout(() => {
                if (gameActive) {
                    player.textContent = 'ü§™';
                    player.style.filter = 'drop-shadow(0 0 10px cyan)';
                }
            }, 500);
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ö–∞–æ—Å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É—Ä–æ–Ω–∞
            chaos = Math.min(100, chaos + 5);
            
            // –°–ª—É—á–∞–π–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—Å–ª–µ —É—Ä–æ–Ω–∞
            if (Math.random() < 0.2) {
                playerX = Math.random() * (window.innerWidth - 100);
                updatePlayerPosition();
                showMessage("–ö–£–î–ê –Ø –ü–û–ü–ê–õ?! ü§î", playerX, window.innerHeight - 100);
            }
        }

        // –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω
        function levelUp() {
            level++;
            chaos = Math.min(100, chaos + 20);
            
            const message = document.getElementById('levelUp');
            message.style.display = 'block';
            
            // –ê–±—Å—É—Ä–¥–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ
            document.body.style.cursor = `url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><circle cx="16" cy="16" r="14" fill="hsl(${Math.random()*360},100%,50%)"/><text x="8" y="22" fill="white" font-size="16">${level}</text></svg>'), auto`;
            
            // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ñ–æ–Ω–∞
            document.body.style.background = `hsl(${Math.random()*360}, 70%, 10%)`;
            
            setTimeout(() => {
                message.style.display = 'none';
            }, 2000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–∞–æ—Å–∞
        function updateChaos() {
            chaos = Math.max(0, chaos - 0.1);
            document.querySelector('.chaos-level').textContent = `üåÄ –•–∞–æ—Å: ${Math.floor(chaos)}%`;
            
            // –≠—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è —Ö–∞–æ—Å–∞
            if (chaos > 70) {
                document.body.style.background = `radial-gradient(circle, hsl(${Math.random()*360},100%,20%) 0%, #000 100%)`;
                
                // –°–ª—É—á–∞–π–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏–≥—Ä–æ–∫–∞
                if (Math.random() < 0.05) {
                    const size = 40 + Math.random() * 80;
                    player.style.fontSize = `${size}px`;
                    setTimeout(() => player.style.fontSize = `80px`, 1000);
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(text, x, y) {
            const msg = document.createElement('div');
            msg.className = 'absurd-message';
            msg.textContent = text;
            msg.style.left = `${x}px`;
            msg.style.top = `${y}px`;
            
            gameArea.appendChild(msg);
            
            setTimeout(() => {
                if (msg.parentNode) {
                    msg.remove();
                }
            }, 2000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞
        function updatePlayerPosition() {
            player.style.left = `${playerX}px`;
            player.style.bottom = `${100 + jumpHeight}px`;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventory() {
            inventoryElement.innerHTML = inventory.join('');
        }

        // –°–ø–∞–≤–Ω —Ñ–æ–Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        function spawnBackgroundObjects() {
            const objects = ['üõ∏', 'üêÑ', 'üçî', 'üé™', 'üè¥‚Äç‚ò†Ô∏è', 'üß®', 'üé≠', 'üåã'];
            
            for (let i = 0; i < 20; i++) {
                const obj = document.createElement('div');
                obj.className = 'background-object';
                obj.textContent = objects[Math.floor(Math.random() * objects.length)];
                obj.style.left = `${Math.random() * window.innerWidth}px`;
                obj.style.fontSize = `${20 + Math.random() * 40}px`;
                obj.style.opacity = 0.1 + Math.random() * 0.3;
                obj.style.animationDuration = `${10 + Math.random() * 30}s`;
                obj.style.animationDelay = `${Math.random() * 5}s`;
                
                gameArea.appendChild(obj);
            }
        }

        // –°–ª—É—á–∞–π–Ω–æ–µ –±–µ–∑—É–º–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
        function randomCrazyEvent() {
            const events = [
                () => { // –ó–æ–º–±–∏ –¥–æ–∂–¥—å
                    for (let i = 0; i < 5; i++) {
                        setTimeout(spawnZombie, i * 200);
                    }
                    showMessage("–ó–û–ú–ë–ò –î–û–ñ–î–¨! ‚òî", window.innerWidth/2, 50);
                },
                () => { // –ò–Ω–≤–µ—Ä—Å–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    showMessage("–ò–ù–í–ï–†–°–ò–Ø! üîÑ", window.innerWidth/2, window.innerHeight/2);
                    const oldJump = jump;
                    jump = function() {
                        playerX = Math.random() * (window.innerWidth - 100);
                        updatePlayerPosition();
                        showMessage("–ê–ô! –ì–î–ï –Ø?!", playerX, window.innerHeight - 100);
                    };
                    setTimeout(() => jump = oldJump, 5000);
                },
                () => { // –ì–∏–≥–∞–Ω—Ç—Å–∫–∏–π –∑–æ–º–±–∏
                    const giant = document.createElement('div');
                    giant.className = 'zombie';
                    giant.textContent = 'üëπ';
                    giant.style.fontSize = '150px';
                    giant.style.left = `${Math.random() * (window.innerWidth - 150)}px`;
                    giant.style.top = `${window.innerHeight + 150}px`;
                    gameArea.appendChild(giant);
                    showMessage("–ë–û–°–°! üëπ", window.innerWidth/2, 100);
                },
                () => { // –í—Å–µ —Ç–∞–Ω—Ü—É—é—Ç
                    document.querySelectorAll('.zombie, .player').forEach(el => {
                        el.style.animation = 'spin 1s infinite linear';
                    });
                    setTimeout(() => {
                        document.querySelectorAll('.zombie, .player').forEach(el => {
                            el.style.animation = '';
                        });
                    }, 3000);
                    showMessage("–í–°–ï –¢–ê–ù–¶–£–Æ–¢! üíÉ", window.innerWidth/2, window.innerHeight/2);
                }
            ];
            
            events[Math.floor(Math.random() * events.length)]();
        }

        // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
        function gameOver() {
            gameActive = false;
            document.getElementById('gameOver').style.display = 'block';
            
            // –ê–±—Å—É—Ä–¥–Ω—ã–µ –∏—Ç–æ–≥–∏
            showMessage(`–¢–í–û–ô –ú–û–ó–ì: ${score}% ü§Ø`, window.innerWidth/2, window.innerHeight/3);
            showMessage(`–£–†–û–í–ï–ù–¨ –ë–ï–ó–£–ú–ò–Ø: ${chaos}% üåÄ`, window.innerWidth/2, window.innerHeight/2);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Telegram (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify({
                    score: score,
                    chaos: chaos,
                    level: level
                }));
            }
        }

        // –†–µ—Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã
        function restartGame() {
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            document.querySelectorAll('.zombie, .trap, .powerup, .absurd-message').forEach(el => el.remove());
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            score = 0;
            time = 60;
            level = 1;
            rage = 0;
            chaos = 0;
            gameActive = true;
            playerX = 50;
            isJumping = false;
            jumpHeight = 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            scoreElement.textContent = `üíÄ –£–±–∏—Ç–æ: 0`;
            timerElement.textContent = `‚è±Ô∏è 60`;
            rageBar.style.width = '0%';
            document.getElementById('gameOver').style.display = 'none';
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–∞
            player.textContent = 'ü§™';
            player.style.fontSize = '80px';
            player.style.filter = 'drop-shadow(0 0 10px cyan)';
            updatePlayerPosition();
            
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
            initGame();
        }

        // –î–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
        document.addEventListener('keydown', (e) => {
            if (!gameActive) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                    playerX = Math.max(0, playerX - 20);
                    break;
                case 'ArrowRight':
                    playerX = Math.min(window.innerWidth - 100, playerX + 20);
                    break;
                case ' ':
                    jump();
                    break;
                case 'a':
                case '—Ñ':
                    shoot('left');
                    break;
                case 'd':
                case '–≤':
                    shoot('right');
                    break;
                case 'q':
                case '–π':
                    usePowerUp();
                    break;
            }
            updatePlayerPosition();
        });

        // –ö–ª–∏–∫ –ø–æ –∏–≥—Ä–æ–∫—É (–∞–±—Å—É—Ä–¥–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç)
        player.onclick = function() {
            if (gameActive) {
                // –°–ª—É—á–∞–π–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å–µ–±—è
                const effects = [
                    () => { player.textContent = 'ü§°'; setTimeout(() => player.textContent = 'ü§™', 1000); },
                    () => { player.style.transform = 'scale(2)'; setTimeout(() => player.style.transform = 'scale(1)', 500); },
                    () => { showMessage("–ó–ê–ß–ï–ú –¢–´ –ñ–ú–Å–®–ï–¨ –ù–ê –ú–ï–ù–Ø?! üò°", playerX, window.innerHeight - 200); }
                ];
                effects[Math.floor(Math.random() * effects.length)]();
            }
        };

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
        
        // –ë–µ–∑—É–º–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        setTimeout(() => {
            showMessage("–ì–û–¢–û–í –ö –ë–ï–ó–£–ú–ò–Æ? ü§™", window.innerWidth/2, window.innerHeight/2);
            document.body.style.cursor = `url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><circle cx="24" cy="24" r="22" fill="lime"/><text x="12" y="32" fill="black" font-size="20">ü§™</text></svg>'), auto`;
        }, 1000);
    </script>
</body>
</html>
